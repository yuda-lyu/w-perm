/*!
 * w-web-perm v1.0.29
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("path"),require("fs"),require("@hapi/hapi"),require("@hapi/inert"),require("events"),require("stream")):"function"==typeof define&&define.amd?define(["path","fs","@hapi/hapi","@hapi/inert","events","stream"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["w-web-perm"]=t(e.path,e.fs,e["@hapi/hapi"],e["@hapi/inert"],e.events,e.stream)}(this,(function(e,t,r,n,u,o){"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===i(t)?t:String(t)}function s(e,t,r){return(t=a(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=Array.isArray,l="object"==typeof global&&global&&global.Object===Object&&global,f="object"==typeof self&&self&&self.Object===Object&&self,D=l||f||Function("return this")(),d=D.Symbol,p=Object.prototype,h=p.hasOwnProperty,g=p.toString,v=d?d.toStringTag:void 0;var m=Object.prototype.toString;var A="[object Null]",y="[object Undefined]",C=d?d.toStringTag:void 0;function F(e){return null==e?void 0===e?y:A:C&&C in Object(e)?function(e){var t=h.call(e,v),r=e[v];try{e[v]=void 0;var n=!0}catch(e){}var u=g.call(e);return n&&(t?e[v]=r:delete e[v]),u}(e):function(e){return m.call(e)}(e)}function b(e){return null!=e&&"object"==typeof e}var E="[object Symbol]";function w(e){return"symbol"==typeof e||b(e)&&F(e)==E}var B=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,j=/^\w*$/;function S(e,t){if(c(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!w(e))||(j.test(e)||!B.test(e)||null!=t&&e in Object(t))}function O(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var x="[object AsyncFunction]",_="[object Function]",T="[object GeneratorFunction]",k="[object Proxy]";function P(e){if(!O(e))return!1;var t=F(e);return t==_||t==T||t==x||t==k}var I,N=D["__core-js_shared__"],$=(I=/[^.]+$/.exec(N&&N.keys&&N.keys.IE_PROTO||""))?"Symbol(src)_1."+I:"";var M=Function.prototype.toString;function U(e){if(null!=e){try{return M.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var R=/^\[object .+?Constructor\]$/,L=Function.prototype,G=Object.prototype,W=L.toString,z=G.hasOwnProperty,H=RegExp("^"+W.call(z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function V(e){return!(!O(e)||(t=e,$&&$ in t))&&(P(e)?H:R).test(U(e));var t}function q(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return V(r)?r:void 0}var Y=q(Object,"create");var J=Object.prototype.hasOwnProperty;var X=Object.prototype.hasOwnProperty;function Z(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Q(e,t){return e===t||e!=e&&t!=t}function K(e,t){for(var r=e.length;r--;)if(Q(e[r][0],t))return r;return-1}Z.prototype.clear=function(){this.__data__=Y?Y(null):{},this.size=0},Z.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Z.prototype.get=function(e){var t=this.__data__;if(Y){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return J.call(t,e)?t[e]:void 0},Z.prototype.has=function(e){var t=this.__data__;return Y?void 0!==t[e]:X.call(t,e)},Z.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Y&&void 0===t?"__lodash_hash_undefined__":t,this};var ee=Array.prototype.splice;function te(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}te.prototype.clear=function(){this.__data__=[],this.size=0},te.prototype.delete=function(e){var t=this.__data__,r=K(t,e);return!(r<0)&&(r==t.length-1?t.pop():ee.call(t,r,1),--this.size,!0)},te.prototype.get=function(e){var t=this.__data__,r=K(t,e);return r<0?void 0:t[r][1]},te.prototype.has=function(e){return K(this.__data__,e)>-1},te.prototype.set=function(e,t){var r=this.__data__,n=K(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};var re=q(D,"Map");function ne(e,t){var r,n,u=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?u["string"==typeof t?"string":"hash"]:u.map}function ue(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ue.prototype.clear=function(){this.size=0,this.__data__={hash:new Z,map:new(re||te),string:new Z}},ue.prototype.delete=function(e){var t=ne(this,e).delete(e);return this.size-=t?1:0,t},ue.prototype.get=function(e){return ne(this,e).get(e)},ue.prototype.has=function(e){return ne(this,e).has(e)},ue.prototype.set=function(e,t){var r=ne(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};var oe="Expected a function";function ie(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(oe);var r=function(){var n=arguments,u=t?t.apply(this,n):n[0],o=r.cache;if(o.has(u))return o.get(u);var i=e.apply(this,n);return r.cache=o.set(u,i)||o,i};return r.cache=new(ie.Cache||ue),r}ie.Cache=ue;var ae,se,ce,le=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,fe=/\\(\\)?/g,De=(ae=function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(le,(function(e,r,n,u){t.push(n?u.replace(fe,"$1"):r||e)})),t},se=ie(ae,(function(e){return 500===ce.size&&ce.clear(),e})),ce=se.cache,se),de=De;function pe(e,t){for(var r=-1,n=null==e?0:e.length,u=Array(n);++r<n;)u[r]=t(e[r],r,e);return u}var he=1/0,ge=d?d.prototype:void 0,ve=ge?ge.toString:void 0;function me(e){if("string"==typeof e)return e;if(c(e))return pe(e,me)+"";if(w(e))return ve?ve.call(e):"";var t=e+"";return"0"==t&&1/e==-he?"-0":t}function Ae(e){return null==e?"":me(e)}function ye(e,t){return c(e)?e:S(e,t)?[e]:de(Ae(e))}var Ce=1/0;function Fe(e){if("string"==typeof e||w(e))return e;var t=e+"";return"0"==t&&1/e==-Ce?"-0":t}function be(e,t){for(var r=0,n=(t=ye(t,e)).length;null!=e&&r<n;)e=e[Fe(t[r++])];return r&&r==n?e:void 0}function Ee(e,t,r){var n=null==e?void 0:be(e,t);return void 0===n?r:n}function we(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}var Be,je=function(e,t,r){for(var n=-1,u=Object(e),o=r(e),i=o.length;i--;){var a=o[Be?i:++n];if(!1===t(u[a],a,u))break}return e};function Se(e){return b(e)&&"[object Arguments]"==F(e)}var Oe=Object.prototype,xe=Oe.hasOwnProperty,_e=Oe.propertyIsEnumerable,Te=Se(function(){return arguments}())?Se:function(e){return b(e)&&xe.call(e,"callee")&&!_e.call(e,"callee")},ke=Te;var Pe="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ie=Pe&&"object"==typeof module&&module&&!module.nodeType&&module,Ne=Ie&&Ie.exports===Pe?D.Buffer:void 0,$e=(Ne?Ne.isBuffer:void 0)||function(){return!1},Me=9007199254740991,Ue=/^(?:0|[1-9]\d*)$/;function Re(e,t){var r=typeof e;return!!(t=null==t?Me:t)&&("number"==r||"symbol"!=r&&Ue.test(e))&&e>-1&&e%1==0&&e<t}var Le=9007199254740991;function Ge(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Le}var We={};function ze(e){return function(t){return e(t)}}We["[object Float32Array]"]=We["[object Float64Array]"]=We["[object Int8Array]"]=We["[object Int16Array]"]=We["[object Int32Array]"]=We["[object Uint8Array]"]=We["[object Uint8ClampedArray]"]=We["[object Uint16Array]"]=We["[object Uint32Array]"]=!0,We["[object Arguments]"]=We["[object Array]"]=We["[object ArrayBuffer]"]=We["[object Boolean]"]=We["[object DataView]"]=We["[object Date]"]=We["[object Error]"]=We["[object Function]"]=We["[object Map]"]=We["[object Number]"]=We["[object Object]"]=We["[object RegExp]"]=We["[object Set]"]=We["[object String]"]=We["[object WeakMap]"]=!1;var He="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ve=He&&"object"==typeof module&&module&&!module.nodeType&&module,qe=Ve&&Ve.exports===He&&l.process,Ye=function(){try{var e=Ve&&Ve.require&&Ve.require("util").types;return e||qe&&qe.binding&&qe.binding("util")}catch(e){}}(),Je=Ye&&Ye.isTypedArray,Xe=Je?ze(Je):function(e){return b(e)&&Ge(e.length)&&!!We[F(e)]},Ze=Object.prototype.hasOwnProperty;function Qe(e,t){var r=c(e),n=!r&&ke(e),u=!r&&!n&&$e(e),o=!r&&!n&&!u&&Xe(e),i=r||n||u||o,a=i?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],s=a.length;for(var l in e)!t&&!Ze.call(e,l)||i&&("length"==l||u&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Re(l,s))||a.push(l);return a}var Ke=Object.prototype;function et(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ke)}function tt(e,t){return function(r){return e(t(r))}}var rt=tt(Object.keys,Object),nt=Object.prototype.hasOwnProperty;function ut(e){if(!et(e))return rt(e);var t=[];for(var r in Object(e))nt.call(e,r)&&"constructor"!=r&&t.push(r);return t}function ot(e){return null!=e&&Ge(e.length)&&!P(e)}function it(e){return ot(e)?Qe(e):ut(e)}var at=function(e,t){return function(r,n){if(null==r)return r;if(!ot(r))return e(r,n);for(var u=r.length,o=t?u:-1,i=Object(r);(t?o--:++o<u)&&!1!==n(i[o],o,i););return r}}((function(e,t){return e&&je(e,t,it)})),st=at;function ct(e){return e}function lt(e,t){var r;return(c(e)?we:st)(e,"function"==typeof(r=t)?r:ct)}function ft(e){var t=this.__data__=new te(e);this.size=t.size}ft.prototype.clear=function(){this.__data__=new te,this.size=0},ft.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},ft.prototype.get=function(e){return this.__data__.get(e)},ft.prototype.has=function(e){return this.__data__.has(e)},ft.prototype.set=function(e,t){var r=this.__data__;if(r instanceof te){var n=r.__data__;if(!re||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new ue(n)}return r.set(e,t),this.size=r.size,this};function Dt(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new ue;++t<r;)this.add(e[t])}function dt(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function pt(e,t){return e.has(t)}Dt.prototype.add=Dt.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Dt.prototype.has=function(e){return this.__data__.has(e)};var ht=1,gt=2;function vt(e,t,r,n,u,o){var i=r&ht,a=e.length,s=t.length;if(a!=s&&!(i&&s>a))return!1;var c=o.get(e),l=o.get(t);if(c&&l)return c==t&&l==e;var f=-1,D=!0,d=r&gt?new Dt:void 0;for(o.set(e,t),o.set(t,e);++f<a;){var p=e[f],h=t[f];if(n)var g=i?n(h,p,f,t,e,o):n(p,h,f,e,t,o);if(void 0!==g){if(g)continue;D=!1;break}if(d){if(!dt(t,(function(e,t){if(!pt(d,t)&&(p===e||u(p,e,r,n,o)))return d.push(t)}))){D=!1;break}}else if(p!==h&&!u(p,h,r,n,o)){D=!1;break}}return o.delete(e),o.delete(t),D}var mt=D.Uint8Array;function At(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function yt(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var Ct=1,Ft=2,bt="[object Boolean]",Et="[object Date]",wt="[object Error]",Bt="[object Map]",jt="[object Number]",St="[object RegExp]",Ot="[object Set]",xt="[object String]",_t="[object Symbol]",Tt="[object ArrayBuffer]",kt="[object DataView]",Pt=d?d.prototype:void 0,It=Pt?Pt.valueOf:void 0;function Nt(e,t){for(var r=-1,n=t.length,u=e.length;++r<n;)e[u+r]=t[r];return e}function $t(e,t,r){var n=t(e);return c(e)?n:Nt(n,r(e))}function Mt(e,t){for(var r=-1,n=null==e?0:e.length,u=0,o=[];++r<n;){var i=e[r];t(i,r,e)&&(o[u++]=i)}return o}function Ut(){return[]}var Rt=Object.prototype.propertyIsEnumerable,Lt=Object.getOwnPropertySymbols,Gt=Lt?function(e){return null==e?[]:(e=Object(e),Mt(Lt(e),(function(t){return Rt.call(e,t)})))}:Ut;function Wt(e){return $t(e,it,Gt)}var zt=1,Ht=Object.prototype.hasOwnProperty;var Vt=q(D,"DataView"),qt=q(D,"Promise"),Yt=q(D,"Set"),Jt=q(D,"WeakMap"),Xt="[object Map]",Zt="[object Promise]",Qt="[object Set]",Kt="[object WeakMap]",er="[object DataView]",tr=U(Vt),rr=U(re),nr=U(qt),ur=U(Yt),or=U(Jt),ir=F;(Vt&&ir(new Vt(new ArrayBuffer(1)))!=er||re&&ir(new re)!=Xt||qt&&ir(qt.resolve())!=Zt||Yt&&ir(new Yt)!=Qt||Jt&&ir(new Jt)!=Kt)&&(ir=function(e){var t=F(e),r="[object Object]"==t?e.constructor:void 0,n=r?U(r):"";if(n)switch(n){case tr:return er;case rr:return Xt;case nr:return Zt;case ur:return Qt;case or:return Kt}return t});var ar=ir,sr=1,cr="[object Arguments]",lr="[object Array]",fr="[object Object]",Dr=Object.prototype.hasOwnProperty;function dr(e,t,r,n,u,o){var i=c(e),a=c(t),s=i?lr:ar(e),l=a?lr:ar(t),f=(s=s==cr?fr:s)==fr,D=(l=l==cr?fr:l)==fr,d=s==l;if(d&&$e(e)){if(!$e(t))return!1;i=!0,f=!1}if(d&&!f)return o||(o=new ft),i||Xe(e)?vt(e,t,r,n,u,o):function(e,t,r,n,u,o,i){switch(r){case kt:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Tt:return!(e.byteLength!=t.byteLength||!o(new mt(e),new mt(t)));case bt:case Et:case jt:return Q(+e,+t);case wt:return e.name==t.name&&e.message==t.message;case St:case xt:return e==t+"";case Bt:var a=At;case Ot:var s=n&Ct;if(a||(a=yt),e.size!=t.size&&!s)return!1;var c=i.get(e);if(c)return c==t;n|=Ft,i.set(e,t);var l=vt(a(e),a(t),n,u,o,i);return i.delete(e),l;case _t:if(It)return It.call(e)==It.call(t)}return!1}(e,t,s,r,n,u,o);if(!(r&sr)){var p=f&&Dr.call(e,"__wrapped__"),h=D&&Dr.call(t,"__wrapped__");if(p||h){var g=p?e.value():e,v=h?t.value():t;return o||(o=new ft),u(g,v,r,n,o)}}return!!d&&(o||(o=new ft),function(e,t,r,n,u,o){var i=r&zt,a=Wt(e),s=a.length;if(s!=Wt(t).length&&!i)return!1;for(var c=s;c--;){var l=a[c];if(!(i?l in t:Ht.call(t,l)))return!1}var f=o.get(e),D=o.get(t);if(f&&D)return f==t&&D==e;var d=!0;o.set(e,t),o.set(t,e);for(var p=i;++c<s;){var h=e[l=a[c]],g=t[l];if(n)var v=i?n(g,h,l,t,e,o):n(h,g,l,e,t,o);if(!(void 0===v?h===g||u(h,g,r,n,o):v)){d=!1;break}p||(p="constructor"==l)}if(d&&!p){var m=e.constructor,A=t.constructor;m==A||!("constructor"in e)||!("constructor"in t)||"function"==typeof m&&m instanceof m&&"function"==typeof A&&A instanceof A||(d=!1)}return o.delete(e),o.delete(t),d}(e,t,r,n,u,o))}function pr(e,t,r,n,u){return e===t||(null==e||null==t||!b(e)&&!b(t)?e!=e&&t!=t:dr(e,t,r,n,pr,u))}var hr=1,gr=2;function vr(e){return e==e&&!O(e)}function mr(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}function Ar(e){var t=function(e){for(var t=it(e),r=t.length;r--;){var n=t[r],u=e[n];t[r]=[n,u,vr(u)]}return t}(e);return 1==t.length&&t[0][2]?mr(t[0][0],t[0][1]):function(r){return r===e||function(e,t,r,n){var u=r.length,o=u,i=!n;if(null==e)return!o;for(e=Object(e);u--;){var a=r[u];if(i&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++u<o;){var s=(a=r[u])[0],c=e[s],l=a[1];if(i&&a[2]){if(void 0===c&&!(s in e))return!1}else{var f=new ft;if(n)var D=n(c,l,s,e,t,f);if(!(void 0===D?pr(l,c,hr|gr,n,f):D))return!1}}return!0}(r,e,t)}}function yr(e,t){return null!=e&&t in Object(e)}function Cr(e,t){return null!=e&&function(e,t,r){for(var n=-1,u=(t=ye(t,e)).length,o=!1;++n<u;){var i=Fe(t[n]);if(!(o=null!=e&&r(e,i)))break;e=e[i]}return o||++n!=u?o:!!(u=null==e?0:e.length)&&Ge(u)&&Re(i,u)&&(c(e)||ke(e))}(e,t,yr)}var Fr=1,br=2;function Er(e){return function(t){return null==t?void 0:t[e]}}function wr(e){return S(e)?Er(Fe(e)):function(e){return function(t){return be(t,e)}}(e)}function Br(e){return"function"==typeof e?e:null==e?ct:"object"==typeof e?c(e)?function(e,t){return S(e)&&vr(t)?mr(Fe(e),t):function(r){var n=Ee(r,e);return void 0===n&&n===t?Cr(r,e):pr(t,n,Fr|br)}}(e[0],e[1]):Ar(e):wr(e)}function jr(e,t){var r=-1,n=ot(e)?Array(e.length):[];return st(e,(function(e,u,o){n[++r]=t(e,u,o)})),n}function Sr(e,t){return(c(e)?pe:jr)(e,Br(t))}var Or="[object String]";var xr=Er("length"),_r=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function Tr(e){return _r.test(e)}var kr="\\ud800-\\udfff",Pr="["+kr+"]",Ir="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Nr="\\ud83c[\\udffb-\\udfff]",$r="[^"+kr+"]",Mr="(?:\\ud83c[\\udde6-\\uddff]){2}",Ur="[\\ud800-\\udbff][\\udc00-\\udfff]",Rr="(?:"+Ir+"|"+Nr+")"+"?",Lr="[\\ufe0e\\ufe0f]?",Gr=Lr+Rr+("(?:\\u200d(?:"+[$r,Mr,Ur].join("|")+")"+Lr+Rr+")*"),Wr="(?:"+[$r+Ir+"?",Ir,Mr,Ur,Pr].join("|")+")",zr=RegExp(Nr+"(?="+Nr+")|"+Wr+Gr,"g");function Hr(e){return Tr(e)?function(e){for(var t=zr.lastIndex=0;zr.test(e);)++t;return t}(e):xr(e)}var Vr="[object Map]",qr="[object Set]";function Yr(e){if(null==e)return 0;if(ot(e))return"string"==typeof(t=e)||!c(t)&&b(t)&&F(t)==Or?Hr(e):e.length;var t,r=ar(e);return r==Vr||r==qr?e.size:ut(e).length}var Jr=Array.prototype.join;function Xr(e){return"[object Object]"===Object.prototype.toString.call(e)}function Zr(e){if(Xr(e)){for(let t in e)return!0;return!1}return!1}function Qr(e){return"[object String]"===Object.prototype.toString.call(e)}function Kr(e){return!(!Qr(e)||""===e)}var en=/\s/;var tn=/^\s+/;function rn(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&en.test(e.charAt(t)););return t}(e)+1).replace(tn,""):e}var nn=NaN,un=/^[-+]0x[0-9a-f]+$/i,on=/^0b[01]+$/i,an=/^0o[0-7]+$/i,sn=parseInt;function cn(e){if("number"==typeof e)return e;if(w(e))return nn;if(O(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=O(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=rn(e);var r=on.test(e);return r||an.test(e)?sn(e.slice(2),r?2:8):un.test(e)?nn:+e}var ln=1/0,fn=17976931348623157e292;function Dn(e){return e?(e=cn(e))===ln||e===-ln?(e<0?-1:1)*fn:e==e?e:0:0===e?e:0}function dn(e){var t=Dn(e),r=t%1;return t==t?r?t-r:t:0}function pn(e){return e!=e}function hn(e){let t=!1;if(Kr(e))t=!isNaN(Number(e));else if(function(e){return"[object Number]"===Object.prototype.toString.call(e)}(e)){if(pn(e))return!1;t=!0}return t}function gn(e){if(!hn(e))return 0;return Dn(e)}function vn(e){return!!hn(e)&&(e=gn(e),"number"==typeof(t=e)&&t==dn(t));var t}var mn=D.isFinite,An=Math.min;var yn=function(e){var t=Math[e];return function(e,r){if(e=cn(e),(r=null==r?0:An(dn(r),292))&&mn(e)){var n=(Ae(e)+"e").split("e");return+((n=(Ae(t(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return t(e)}}("round"),Cn=yn;function Fn(e){if(!hn(e))return 0;e=gn(e);let t=Cn(e);return"0"===String(t)?0:t}function bn(e){if(!vn(e))return!1;return Fn(e)>0}function En(e){return"[object Array]"===Object.prototype.toString.call(e)}function wn(e){return"[object Undefined]"===Object.prototype.toString.call(e)}function Bn(e){if(Xr(e)){for(let t in e)return!1;return!0}return!1}function jn(e){return!!wn(e)||(!!function(e){return"[object Null]"===Object.prototype.toString.call(e)}(e)||(!!Bn(e)||(!!function(e){return!(!Qr(e)||""!==e)}(e)||(!!function(e){return!!En(e)&&0===e.length}(e)||!!pn(e)))))}function Sn(e){return!!En(e)&&(0!==e.length&&(1!==e.length||!jn(e[0])))}function On(e){let t=Object.prototype.toString.call(e);return"[object Function]"===t||"[object AsyncFunction]"===t}function xn(e){let t,r=Object.prototype.toString.call(e);if(t="[object Promise]"===r,t)return!0;if("[object Function]"!==r)return!1;try{t="function"!=typeof e.subscribe&&"function"==typeof e.then}catch(e){}return t}function _n(e){if(!Kr(e))return{};let t={};try{t=JSON.parse(e)}catch(e){t={}}return t}function Tn(e){if(!vn(e))return!1;return Fn(e)>=0}function kn(e,t){return Kr(e)&&Tn(t)?0===(t=Fn(t))?"":e.substring(0,t):""}function Pn(){let e,t,r=new Promise((function(){e=arguments[0],t=arguments[1]}));return r.resolve=e,r.reject=t,r}let In=function(e){if(!On(e))throw new Error("fn is not a function");return function(){let t=Pn(),r=null,n=null;try{r=e.apply(this,arguments)}catch(e){n=e}return null!==n?t.resolve({state:"error",msg:n}):xn(r)?r.then((e=>{t.resolve({state:"success",msg:e})})).catch((e=>{"cancelled"===Ee(e,"reason")?t.resolve({state:"cancelled",msg:""}):t.resolve({state:"error",msg:e})})):t.resolve({state:"success",msg:r}),t}};function Nn(e){return!!t.existsSync(e)&&(!t.lstatSync(e).isDirectory()&&!t.lstatSync(e).isSymbolicLink())}function $n(e,t,r){if(!Kr(e))return"";if(!Kr(t))return"";if(!Qr(r))return"";return String(e).replaceAll(t,r)}function Mn(e,t){return!!Xr(e)&&(!(!Kr(t)&&!hn(t))&&t in e)}function Un(e,t){return pr(e,t)}function Rn(e,t){function r(e){return En(e)?e:[e]}if(jn(e))return!1;if(0===(e=r(e)).length)return!1;if(jn(e))return!1;if(0===(t=r(t)).length)return!1;for(let r=0;r<e.length;r++)for(let n=0;n<t.length;n++)if(Un(e[r],t[n]))return!0;return!1}function Ln(e,t,r,n){for(var u=e.length,o=r+(n?1:-1);n?o--:++o<u;)if(t(e[o],o,e))return o;return-1}var Gn=Math.max;var Wn,zn=(Wn=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var u=null==r?0:dn(r);return u<0&&(u=Gn(n+u,0)),Ln(e,Br(t),u)},function(e,t,r){var n=Object(e);if(!ot(e)){var u=Br(t);e=it(e),t=function(e){return u(n[e],e,n)}}var o=Wn(e,t,r);return o>-1?n[u?e[o]:o]:void 0});function Hn(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!Sn(t))return{};let n={};return lt(t,(function(t){n[t]=Ee(e,t,r)})),n}function Vn(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return Sn(e)&&Sn(t)?Sr(e,(e=>Hn(e,t,r))):[]}var qn="[object Boolean]";function Yn(e){return!0===(t=e)||!1===t||b(t)&&F(t)==qn;var t}var Jn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Xn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Zn={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function u(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new u(n,o||e,i),s=r?r+t:t;return e._events[s]?e._events[s].fn?e._events[s]=[e._events[s],a]:e._events[s].push(a):(e._events[s]=a,e._eventsCount++),e}function i(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,u=[];if(0===this._eventsCount)return u;for(n in e=this._events)t.call(e,n)&&u.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(e)):u},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var u=0,o=n.length,i=new Array(o);u<o;u++)i[u]=n[u].fn;return i},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,u,o,i){var a=r?r+e:e;if(!this._events[a])return!1;var s,c,l=this._events[a],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,u),!0;case 5:return l.fn.call(l.context,t,n,u,o),!0;case 6:return l.fn.call(l.context,t,n,u,o,i),!0}for(c=1,s=new Array(f-1);c<f;c++)s[c-1]=arguments[c];l.fn.apply(l.context,s)}else{var D,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),f){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,n);break;case 4:l[c].fn.call(l[c].context,t,n,u);break;default:if(!s)for(D=1,s=new Array(f-1);D<f;D++)s[D-1]=arguments[D];l[c].fn.apply(l[c].context,s)}}return!0},a.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,u){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return i(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||u&&!a.once||n&&a.context!==n||i(this,o);else{for(var s=0,c=[],l=a.length;s<l;s++)(a[s].fn!==t||u&&!a[s].once||n&&a[s].context!==n)&&c.push(a[s]);c.length?this._events[o]=1===c.length?c[0]:c:i(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&i(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a}(Zn);var Qn=Xn(Zn.exports);function Kn(){return new Qn}var eu=function(){try{var e=q(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),tu=eu;function ru(e,t,r){"__proto__"==t&&tu?tu(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var nu=Object.prototype.hasOwnProperty;function uu(e,t,r){var n=e[t];nu.call(e,t)&&Q(n,r)&&(void 0!==r||t in e)||ru(e,t,r)}function ou(e,t,r,n){var u=!r;r||(r={});for(var o=-1,i=t.length;++o<i;){var a=t[o],s=n?n(r[a],e[a],a,r,e):void 0;void 0===s&&(s=e[a]),u?ru(r,a,s):uu(r,a,s)}return r}var iu=Object.prototype.hasOwnProperty;function au(e){if(!O(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=et(e),r=[];for(var n in e)("constructor"!=n||!t&&iu.call(e,n))&&r.push(n);return r}function su(e){return ot(e)?Qe(e,!0):au(e)}var cu="object"==typeof exports&&exports&&!exports.nodeType&&exports,lu=cu&&"object"==typeof module&&module&&!module.nodeType&&module,fu=lu&&lu.exports===cu?D.Buffer:void 0,Du=fu?fu.allocUnsafe:void 0;function du(e,t){if(t)return e.slice();var r=e.length,n=Du?Du(r):new e.constructor(r);return e.copy(n),n}function pu(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var hu=tt(Object.getPrototypeOf,Object),gu=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Nt(t,Gt(e)),e=hu(e);return t}:Ut,vu=gu;function mu(e){return $t(e,su,vu)}var Au=Object.prototype.hasOwnProperty;function yu(e){var t=new e.constructor(e.byteLength);return new mt(t).set(new mt(e)),t}var Cu=/\w*$/;var Fu=d?d.prototype:void 0,bu=Fu?Fu.valueOf:void 0;function Eu(e,t){var r=t?yu(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var wu="[object Boolean]",Bu="[object Date]",ju="[object Map]",Su="[object Number]",Ou="[object RegExp]",xu="[object Set]",_u="[object String]",Tu="[object Symbol]",ku="[object ArrayBuffer]",Pu="[object DataView]",Iu="[object Float32Array]",Nu="[object Float64Array]",$u="[object Int8Array]",Mu="[object Int16Array]",Uu="[object Int32Array]",Ru="[object Uint8Array]",Lu="[object Uint8ClampedArray]",Gu="[object Uint16Array]",Wu="[object Uint32Array]";function zu(e,t,r){var n,u=e.constructor;switch(t){case ku:return yu(e);case wu:case Bu:return new u(+e);case Pu:return function(e,t){var r=t?yu(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case Iu:case Nu:case $u:case Mu:case Uu:case Ru:case Lu:case Gu:case Wu:return Eu(e,r);case ju:return new u;case Su:case _u:return new u(e);case Ou:return function(e){var t=new e.constructor(e.source,Cu.exec(e));return t.lastIndex=e.lastIndex,t}(e);case xu:return new u;case Tu:return n=e,bu?Object(bu.call(n)):{}}}var Hu=Object.create,Vu=function(){function e(){}return function(t){if(!O(t))return{};if(Hu)return Hu(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),qu=Vu;function Yu(e){return"function"!=typeof e.constructor||et(e)?{}:qu(hu(e))}var Ju=Ye&&Ye.isMap,Xu=Ju?ze(Ju):function(e){return b(e)&&"[object Map]"==ar(e)};var Zu=Ye&&Ye.isSet,Qu=Zu?ze(Zu):function(e){return b(e)&&"[object Set]"==ar(e)},Ku=1,eo=2,to=4,ro="[object Arguments]",no="[object Function]",uo="[object GeneratorFunction]",oo="[object Object]",io={};function ao(e,t,r,n,u,o){var i,a=t&Ku,s=t&eo,l=t&to;if(r&&(i=u?r(e,n,u,o):r(e)),void 0!==i)return i;if(!O(e))return e;var f=c(e);if(f){if(i=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&Au.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(e),!a)return pu(e,i)}else{var D=ar(e),d=D==no||D==uo;if($e(e))return du(e,a);if(D==oo||D==ro||d&&!u){if(i=s||d?{}:Yu(e),!a)return s?function(e,t){return ou(e,vu(e),t)}(e,function(e,t){return e&&ou(t,su(t),e)}(i,e)):function(e,t){return ou(e,Gt(e),t)}(e,function(e,t){return e&&ou(t,it(t),e)}(i,e))}else{if(!io[D])return u?e:{};i=zu(e,D,a)}}o||(o=new ft);var p=o.get(e);if(p)return p;o.set(e,i),Qu(e)?e.forEach((function(n){i.add(ao(n,t,r,n,e,o))})):Xu(e)&&e.forEach((function(n,u){i.set(u,ao(n,t,r,u,e,o))}));var h=f?void 0:(l?s?mu:Wt:s?su:it)(e);return we(h||e,(function(n,u){h&&(n=e[u=n]),uu(i,u,ao(n,t,r,u,e,o))})),i}io[ro]=io["[object Array]"]=io["[object ArrayBuffer]"]=io["[object DataView]"]=io["[object Boolean]"]=io["[object Date]"]=io["[object Float32Array]"]=io["[object Float64Array]"]=io["[object Int8Array]"]=io["[object Int16Array]"]=io["[object Int32Array]"]=io["[object Map]"]=io["[object Number]"]=io[oo]=io["[object RegExp]"]=io["[object Set]"]=io["[object String]"]=io["[object Symbol]"]=io["[object Uint8Array]"]=io["[object Uint8ClampedArray]"]=io["[object Uint16Array]"]=io["[object Uint32Array]"]=!0,io["[object Error]"]=io[no]=io["[object WeakMap]"]=!1;var so=1,co=4;function lo(e){return ao(e,so|co)}function fo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Kn(),r={},n=null,u=Ee(e,"timeAlive");bn(u)||(u=1e4),u=Fn(u);let o=Ee(e,"timeDetect");return bn(o)||(o=50),o=Fn(o),t.trigger=function(e,i){Kr(e)?(Mn(r,e)||setTimeout((()=>{t.emit("message",{eventName:"enter",key:e,data:i,now:Yr(r)})}),1),r[e]={data:i,time:Date.now()},null===n&&(n=setInterval((()=>{lt(r,((e,n)=>{if(Date.now()-e.time>u){let e=lo(r[n]);delete r[n],t.emit("message",{eventName:"leave",key:n,data:e.data,now:Yr(r)})}})),Zr(r)||(clearInterval(n),n=null)}),o))):console.log("trigger need key")},t.get=function(){let e=[];return lt(r,((t,r)=>{e.push({key:r,data:t.data})})),e=lo(e),e},t}function Do(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}function po(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)}function ho(e){return"[object Uint16Array]"===Object.prototype.toString.call(e)}function go(e){if(!(Do(e)||(t=e,"[object Blob]"===Object.prototype.toString.call(t))||po(e)||ho(e)))return null;var t;try{if(e.byteLength)return e.byteLength}catch(e){}try{if(e.length)return e.length}catch(e){}try{if(e.size)return e.size}catch(e){}return null}var vo="[object Object]",mo=Function.prototype,Ao=Object.prototype,yo=mo.toString,Co=Ao.hasOwnProperty,Fo=yo.call(Object);function bo(e){if(!b(e)||F(e)!=vo)return!1;var t=hu(e);if(null===t)return!0;var r=Co.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&yo.call(r)==Fo}var Eo="[object DOMException]",wo="[object Error]";function Bo(e){if(!Xr(e))return{results:"",binarys:[]};if(Bn(e))return{results:"",binarys:[]};let t="",r=[];try{let n=-1;t=JSON.stringify(e,(function(e,t){if(po(t)){n+=1;let e=`[Uint8Array]::${n}`;return r.push(t),e}if(ho(t)){n+=1;let e=`[Uint16Array]::${n}`;return r.push(t),e}if(Do(t)){n+=1;let e=`[ArrayBuffer]::${n}`;return r.push(t),e}return function(e){if(!b(e))return!1;var t=F(e);return t==wo||t==Eo||"string"==typeof e.message&&"string"==typeof e.name&&!bo(e)}(t)&&(t=t.toString()),t}))}catch(e){}return{results:t,binarys:r}}var jo={exports:{}};var So,Oo={exports:{}};function xo(){return So||(So=1,function(e,t){var r;e.exports=(r=r||function(e,t){var r;if("undefined"!=typeof window&&window.crypto&&(r=window.crypto),"undefined"!=typeof self&&self.crypto&&(r=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(r=globalThis.crypto),!r&&"undefined"!=typeof window&&window.msCrypto&&(r=window.msCrypto),!r&&void 0!==Jn&&Jn.crypto&&(r=Jn.crypto),!r)try{r=require("crypto")}catch(e){}var n=function(){if(r){if("function"==typeof r.getRandomValues)try{return r.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof r.randomBytes)try{return r.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},u=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),o={},i=o.lib={},a=i.Base={extend:function(e){var t=u(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=i.WordArray=a.extend({init:function(e,r){e=this.words=e||[],this.sigBytes=r!=t?r:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,u=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<u;o++){var i=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=i<<24-(n+o)%4*8}else for(var a=0;a<u;a+=4)t[n+a>>>2]=r[a>>>2];return this.sigBytes+=u,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(n());return new s.init(t,e)}}),c=o.enc={},l=c.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],u=0;u<r;u++){var o=t[u>>>2]>>>24-u%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new s.init(r,t/2)}},f=c.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],u=0;u<r;u++){var o=t[u>>>2]>>>24-u%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new s.init(r,t)}},D=c.Utf8={stringify:function(e){try{return decodeURIComponent(escape(f.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return f.parse(unescape(encodeURIComponent(e)))}},d=i.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=D.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r,n=this._data,u=n.words,o=n.sigBytes,i=this.blockSize,a=o/(4*i),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*i,l=e.min(4*c,o);if(c){for(var f=0;f<c;f+=i)this._doProcessBlock(u,f);r=u.splice(0,c),n.sigBytes-=l}return new s.init(r,l)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});i.Hasher=d.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new p.HMAC.init(e,r).finalize(t)}}});var p=o.algo={};return o}(Math),r)}(Oo)),Oo.exports}!function(e,t){e.exports=xo().enc.Utf8}(jo);var _o=Xn(jo.exports),To={exports:{}};!function(e,t){var r;e.exports=(r=xo(),function(){var e=r,t=e.lib.WordArray;function n(e,r,n){for(var u=[],o=0,i=0;i<r;i++)if(i%4){var a=n[e.charCodeAt(i-1)]<<i%4*2|n[e.charCodeAt(i)]>>>6-i%4*2;u[o>>>2]|=a<<24-o%4*8,o++}return t.create(u,o)}e.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp();for(var u=[],o=0;o<r;o+=3)for(var i=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<r;a++)u.push(n.charAt(i>>>6*(3-a)&63));var s=n.charAt(64);if(s)for(;u.length%4;)u.push(s);return u.join("")},parse:function(e){var t=e.length,r=this._map,u=this._reverseMap;if(!u){u=this._reverseMap=[];for(var o=0;o<r.length;o++)u[r.charCodeAt(o)]=o}var i=r.charAt(64);if(i){var a=e.indexOf(i);-1!==a&&(t=a)}return n(e,t,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),r.enc.Base64)}(To);var ko=Xn(To.exports);function Po(e){if(!Kr(e))return new Uint8Array;let t;try{t=function(e){if(!Qr(e))return new Uint8Array;let t=ko.parse(e),r=t.words,n=t.sigBytes,u=new Uint8Array(n);for(let e=0;e<n;e++){let t=r[e>>>2]>>>24-e%4*8&255;u[e]=t}return u}(function(e){if(!Kr(e))return"";let t=_o.parse(e);return ko.stringify(t)}(e))}catch(e){return new Uint8Array}return t}function Io(e,t){return function(e,t,r,n,u,o){if(!hn(e))return null;if(!po(t))return null;if(!vn(r))return null;if(!Yn(n))return null;if(!vn(u))return null;if(!vn(o))return null;let i,a,s;e=gn(e);let c=8*o-u-1,l=(1<<c)-1,f=l>>1,D=23===u?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?o-1:0,p=n?-1:1,h=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,i=l):(i=Math.floor(Math.log(e)/Math.LN2),e*(s=Math.pow(2,-i))<1&&(i--,s*=2),(e+=i+f>=1?D/s:D*Math.pow(2,1-f))*s>=2&&(i++,s/=2),i+f>=l?(a=0,i=l):i+f>=1?(a=(e*s-1)*Math.pow(2,u),i+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,u),i=0));u>=8;t[r+d]=255&a,d+=p,a/=256,u-=8);for(i=i<<u|a,c+=u;c>0;t[r+d]=255&i,d+=p,i/=256,c-=8);return t[r+d-p]|=128*h,null}(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,!(arguments.length>3&&void 0!==arguments[3])||arguments[3],arguments.length>4&&void 0!==arguments[4]?arguments[4]:52,arguments.length>5&&void 0!==arguments[5]?arguments[5]:8)}function No(e){let t=[],r=[];if(!Sn(e)&&!Zr(e))return null;let n=[],u=[];function o(e){n.push(go(e)),u.push(e)}try{let i=Bo(e);o(Po(i.results)),lt(i.binarys,(e=>{o(e)}));let a=n,s=Po(JSON.stringify(a)),c=new Uint8Array(8);Io(go(s),c),t.push(c),t.push(s),lt(u,(e=>{t.push(e)})),lt(t,(e=>{r=function(e,t){let r=go(e),n=go(t),u=new Uint8Array(r+n);return u.set(new Uint8Array(e),0),u.set(new Uint8Array(t),r),u}(r,e)}))}catch(e){return null}return r}function $o(e){return function(e,t,r,n,u){if(!po(e))return null;if(!vn(t))return null;if(!Yn(r))return null;if(!vn(n))return null;if(!vn(u))return null;let o,i,a=8*u-n-1,s=(1<<a)-1,c=s>>1,l=-7,f=r?0:u-1,D=r?1:-1,d=e[t+f];for(f+=D,o=d&(1<<-l)-1,d>>=-l,l+=a;l>0;o=256*o+e[t+f],f+=D,l-=8);for(i=o&(1<<-l)-1,o>>=-l,l+=n;l>0;i=256*i+e[t+f],f+=D,l-=8);if(0===o)o=1-c;else{if(o===s)return i?NaN:1/0*(d?-1:1);i+=Math.pow(2,n),o-=c}return(d?-1:1)*i*Math.pow(2,o-n)}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,!(arguments.length>2&&void 0!==arguments[2])||arguments[2],arguments.length>3&&void 0!==arguments[3]?arguments[3]:52,arguments.length>4&&void 0!==arguments[4]?arguments[4]:8)}var Mo={exports:{}};!function(e,t){var r;e.exports=(r=xo(),function(){if("function"==typeof ArrayBuffer){var e=r.lib.WordArray,t=e.init,n=e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var r=e.byteLength,n=[],u=0;u<r;u++)n[u>>>2]|=e[u]<<24-u%4*8;t.call(this,n,r)}else t.apply(this,arguments)};n.prototype=e}}(),r.lib.WordArray)}(Mo);var Uo=Xn(Mo.exports);function Ro(e){if(!po(e))return"";let t;try{r=function(e){return po(e)?Uo.create(e).toString(ko):""}(e),t=Kr(r)?ko.parse(r).toString(_o):""}catch(e){return""}var r;return t}function Lo(e){let t=null;if(!po(e))return null;try{let r=8,n=e.slice(0,r),u=e.slice(r,go(e)),o=$o(n),i=u.slice(0,o),a=u.slice(o,go(u)),s=Ro(i),c=function(e,t){let r=0,n=0,u=[];return lt(t,(t=>{n=r+t;let o=e.slice(r,n);r=n,u.push(o)})),u}(a,JSON.parse(s));t=function(e){if(!Zr(e))return{};let{results:t,binarys:r}=e;if(!Kr(t))return{};if(!En(r))return{};let n={};try{n=JSON.parse(t,(function(e,t){if(Kr(t)){if(t.indexOf("[Uint8Array]::")>=0){let e=Fn(t.replace("[Uint8Array]::",""));return r[e]}if(t.indexOf("[Uint16Array]::")>=0){let e=Fn(t.replace("[Uint16Array]::",""));return r[e]}if(t.indexOf("[ArrayBuffer]::")>=0){let e=Fn(t.replace("[ArrayBuffer]::",""));return r[e]}}return t}))}catch(e){}return n}({results:Ro(c.shift()),binarys:c})}catch(e){}return t}function Go(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};e.port||(e.port=8080),e.apiName||(e.apiName="api");let i,a=new u.EventEmitter,s=fo();function c(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];setTimeout((()=>{a.emit(e,...r)}),1)}async function l(e){let r=Pn(),n=Pn(),u=Ee(e,"_mode","");if(n.then((t=>{e.output=t,delete e.input,r.resolve(e)})).catch((e=>{r.reject(e)})),"execute"===u){c("execute",Ee(e,"func",""),Ee(e,"input",null),n)}else if("broadcast"===u){c("broadcast",Ee(e,"input",null)),n.resolve("ok")}else if("deliver"===u){c("deliver",Ee(e,"input",null)),n.resolve("ok")}else if("polling"===u){let r=Ee(e,"clientId",""),u=Ee(t,r,[]);u=lo(u),t[r]=[],n.resolve(u)}else{let t="can not find _mode in data";!function(e,t){c("error",{msg:e,err:t})}(t,e),r.reject(t),n.reject()}return r}setInterval((()=>{let e=Sr(s.get(),"key"),r={};lt(e,(e=>{r[e]=Ee(t,e,[])})),t=r}),1e3),i=e.serverHapi?e.serverHapi:r.server({port:e.port,routes:{cors:{origin:["*"]}}}),c("open"),s.on("message",(function(e){let{eventName:t,key:r,data:n,now:u}=e;"enter"===t?c("clientEnter",r,n):"leave"===t&&c("clientLeave",r,n),c("clientChange",u)}));let f={path:"/"+e.apiName,method:"POST",options:{payload:{maxBytes:1073741824,timeout:18e4,multipart:!0},timeout:{socket:3e5}},handler:async function(e,t){let r=Ee(e,"headers");r=Zr(r)?r:"";let n=Ee(e,"query");n=Zr(n)?n:"",c("handler",{headers:r,query:n});let u=Ee(e,"payload.bb",null);Qr(u)&&(u=Buffer.from(u,"utf8"));let i=Lo(new Uint8Array(u)),a=Ee(i,"clientId"),f={headers:e.headers,info:e.info};s.trigger(a,f);let D={};await l(i).then((function(e){D.success=e})).catch((function(e){D.error=e}));let d=No(D),p=new o.Readable;return p._read=()=>{},p.push(d),p.push(null),t.response(p).header("Cache-Control","no-cache, no-store, must-revalidate").header("Content-Type","application/octet-stream").header("Content-Length",p.readableLength)}};return a.broadcast=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};if(jn(t))return;let n={};lt(t,((t,r)=>{t.push({mode:"broadcast",data:e}),n[r]=t})),t=n,r(100)},a.deliver=function(e,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},u=Ee(t,e,[]);u.push({mode:"deliver",data:r}),t[e]=u,n(100)},e.serverHapi?e.serverHapi.route(f):async function(){await i.register(n),i.route([{method:"GET",path:"/{file*}",handler:{directory:{path:"./"}}},f]),await i.start(),console.log(`Server running at: ${i.info.uri}`)}(),a}let Wo="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),zo=Wo.length;function Ho(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,t=[];e=bn(e)?Fn(e):32;for(let r=0;r<e;r++)t[r]=Wo[0|Math.random()*zo];return t.join("")}var Vo=function(){return D.Date.now()},qo="Expected a function",Yo=Math.max,Jo=Math.min;function Xo(e,t,r){var n,u,o,i,a,s,c=0,l=!1,f=!1,D=!0;if("function"!=typeof e)throw new TypeError(qo);function d(t){var r=n,o=u;return n=u=void 0,c=t,i=e.apply(o,r)}function p(e){var r=e-s;return void 0===s||r>=t||r<0||f&&e-c>=o}function h(){var e=Vo();if(p(e))return g(e);a=setTimeout(h,function(e){var r=t-(e-s);return f?Jo(r,o-(e-c)):r}(e))}function g(e){return a=void 0,D&&n?d(e):(n=u=void 0,i)}function v(){var e=Vo(),r=p(e);if(n=arguments,u=this,s=e,r){if(void 0===a)return function(e){return c=e,a=setTimeout(h,t),l?d(e):i}(s);if(f)return clearTimeout(a),a=setTimeout(h,t),d(s)}return void 0===a&&(a=setTimeout(h,t)),i}return t=cn(t)||0,O(r)&&(l=!!r.leading,o=(f="maxWait"in r)?Yo(cn(r.maxWait)||0,t):o,D="trailing"in r?!!r.trailing:D),v.cancel=function(){void 0!==a&&clearTimeout(a),c=0,n=s=u=a=void 0},v.flush=function(){return void 0===a?i:g(Vo())},v}function Zo(e,t,r){(void 0!==r&&!Q(e[t],r)||void 0===r&&!(t in e))&&ru(e,t,r)}function Qo(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function Ko(e,t,r,n,u,o,i){var a=Qo(e,r),s=Qo(t,r),l=i.get(s);if(l)Zo(e,r,l);else{var f,D=o?o(a,s,r+"",e,t,i):void 0,d=void 0===D;if(d){var p=c(s),h=!p&&$e(s),g=!p&&!h&&Xe(s);D=s,p||h||g?c(a)?D=a:b(f=a)&&ot(f)?D=pu(a):h?(d=!1,D=du(s,!0)):g?(d=!1,D=Eu(s,!0)):D=[]:bo(s)||ke(s)?(D=a,ke(a)?D=function(e){return ou(e,su(e))}(a):O(a)&&!P(a)||(D=Yu(s))):d=!1}d&&(i.set(s,D),u(D,s,n,o,i),i.delete(s)),Zo(e,r,D)}}function ei(e,t,r,n,u){e!==t&&je(t,(function(o,i){if(u||(u=new ft),O(o))Ko(e,t,i,r,ei,n,u);else{var a=n?n(Qo(e,i),o,i+"",e,t,u):void 0;void 0===a&&(a=o),Zo(e,i,a)}}),su)}var ti=Math.max;var ri=tu?function(e,t){return tu(e,"toString",{configurable:!0,enumerable:!1,value:(r=t,function(){return r}),writable:!0});var r}:ct,ni=ri,ui=Date.now;var oi=function(e){var t=0,r=0;return function(){var n=ui(),u=16-(n-r);if(r=n,u>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(ni),ii=oi;function ai(e,t){return ii(function(e,t,r){return t=ti(void 0===t?e.length-1:t,0),function(){for(var n=arguments,u=-1,o=ti(n.length-t,0),i=Array(o);++u<o;)i[u]=n[t+u];u=-1;for(var a=Array(t+1);++u<t;)a[u]=n[u];return a[t]=r(i),function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}(e,this,a)}}(e,t,ct),e+"")}var si,ci=(si=function(e,t,r){ei(e,t,r)},ai((function(e,t){var r=-1,n=t.length,u=n>1?t[n-1]:void 0,o=n>2?t[2]:void 0;for(u=si.length>3&&"function"==typeof u?(n--,u):void 0,o&&function(e,t,r){if(!O(r))return!1;var n=typeof t;return!!("number"==n?ot(r)&&Re(t,r.length):"string"==n&&t in r)&&Q(r[t],e)}(t[0],t[1],o)&&(u=n<3?void 0:u,n=1),e=Object(e);++r<n;){var i=t[r];i&&si(e,i,r,u)}return e}))),li={exports:{}};!function(e,t){e.exports=function(){var e=1e3,t=6e4,r=36e5,n="millisecond",u="second",o="minute",i="hour",a="day",s="week",c="month",l="quarter",f="year",D="date",d="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,h=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||t[0])+"]"}},v=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},m={s:v,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),u=r%60;return(t<=0?"+":"-")+v(n,2,"0")+":"+v(u,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),u=t.clone().add(n,c),o=r-u<0,i=t.clone().add(n+(o?-1:1),c);return+(-(n+(r-u)/(o?u-i:i-u))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:f,w:s,d:a,D:D,h:i,m:o,s:u,ms:n,Q:l}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},A="en",y={};y[A]=g;var C="$isDayjsObject",F=function(e){return e instanceof B||!(!e||!e[C])},b=function e(t,r,n){var u;if(!t)return A;if("string"==typeof t){var o=t.toLowerCase();y[o]&&(u=o),r&&(y[o]=r,u=o);var i=t.split("-");if(!u&&i.length>1)return e(i[0])}else{var a=t.name;y[a]=t,u=a}return!n&&u&&(A=u),u||!n&&A},E=function(e,t){if(F(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new B(r)},w=m;w.l=b,w.i=F,w.w=function(e,t){return E(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var B=function(){function g(e){this.$L=b(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[C]=!0}var v=g.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(w.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(p);if(n){var u=n[2]-1||0,o=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],u,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],u,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(t)}(e),this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return w},v.isValid=function(){return!(this.$d.toString()===d)},v.isSame=function(e,t){var r=E(e);return this.startOf(t)<=r&&r<=this.endOf(t)},v.isAfter=function(e,t){return E(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<E(e)},v.$g=function(e,t,r){return w.u(e)?this[t]:this.set(r,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var r=this,n=!!w.u(t)||t,l=w.p(e),d=function(e,t){var u=w.w(r.$u?Date.UTC(r.$y,t,e):new Date(r.$y,t,e),r);return n?u:u.endOf(a)},p=function(e,t){return w.w(r.toDate()[e].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),r)},h=this.$W,g=this.$M,v=this.$D,m="set"+(this.$u?"UTC":"");switch(l){case f:return n?d(1,0):d(31,11);case c:return n?d(1,g):d(0,g+1);case s:var A=this.$locale().weekStart||0,y=(h<A?h+7:h)-A;return d(n?v-y:v+(6-y),g);case a:case D:return p(m+"Hours",0);case i:return p(m+"Minutes",1);case o:return p(m+"Seconds",2);case u:return p(m+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var r,s=w.p(e),l="set"+(this.$u?"UTC":""),d=(r={},r[a]=l+"Date",r[D]=l+"Date",r[c]=l+"Month",r[f]=l+"FullYear",r[i]=l+"Hours",r[o]=l+"Minutes",r[u]=l+"Seconds",r[n]=l+"Milliseconds",r)[s],p=s===a?this.$D+(t-this.$W):t;if(s===c||s===f){var h=this.clone().set(D,1);h.$d[d](p),h.init(),this.$d=h.set(D,Math.min(this.$D,h.daysInMonth())).$d}else d&&this.$d[d](p);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[w.p(e)]()},v.add=function(n,l){var D,d=this;n=Number(n);var p=w.p(l),h=function(e){var t=E(d);return w.w(t.date(t.date()+Math.round(e*n)),d)};if(p===c)return this.set(c,this.$M+n);if(p===f)return this.set(f,this.$y+n);if(p===a)return h(1);if(p===s)return h(7);var g=(D={},D[o]=t,D[i]=r,D[u]=e,D)[p]||1,v=this.$d.getTime()+n*g;return w.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||d;var n=e||"YYYY-MM-DDTHH:mm:ssZ",u=w.z(this),o=this.$H,i=this.$m,a=this.$M,s=r.weekdays,c=r.months,l=r.meridiem,f=function(e,r,u,o){return e&&(e[r]||e(t,n))||u[r].slice(0,o)},D=function(e){return w.s(o%12||12,e,"0")},p=l||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(h,(function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return w.s(t.$y,4,"0");case"M":return a+1;case"MM":return w.s(a+1,2,"0");case"MMM":return f(r.monthsShort,a,c,3);case"MMMM":return f(c,a);case"D":return t.$D;case"DD":return w.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return f(r.weekdaysMin,t.$W,s,2);case"ddd":return f(r.weekdaysShort,t.$W,s,3);case"dddd":return s[t.$W];case"H":return String(o);case"HH":return w.s(o,2,"0");case"h":return D(1);case"hh":return D(2);case"a":return p(o,i,!0);case"A":return p(o,i,!1);case"m":return String(i);case"mm":return w.s(i,2,"0");case"s":return String(t.$s);case"ss":return w.s(t.$s,2,"0");case"SSS":return w.s(t.$ms,3,"0");case"Z":return u}return null}(e)||u.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(n,D,d){var p,h=this,g=w.p(D),v=E(n),m=(v.utcOffset()-this.utcOffset())*t,A=this-v,y=function(){return w.m(h,v)};switch(g){case f:p=y()/12;break;case c:p=y();break;case l:p=y()/3;break;case s:p=(A-m)/6048e5;break;case a:p=(A-m)/864e5;break;case i:p=A/r;break;case o:p=A/t;break;case u:p=A/e;break;default:p=A}return d?p:w.a(p)},v.daysInMonth=function(){return this.endOf(c).$D},v.$locale=function(){return y[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=b(e,t,!0);return n&&(r.$L=n),r},v.clone=function(){return w.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},g}(),j=B.prototype;return E.prototype=j,[["$ms",n],["$s",u],["$m",o],["$H",i],["$W",a],["$M",c],["$y",f],["$D",D]].forEach((function(e){j[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),E.extend=function(e,t){return e.$i||(e(t,B,E),e.$i=!0),E},E.locale=b,E.isDayjs=F,E.unix=function(e){return E(1e3*e)},E.en=y[A],E.Ls=y,E.p={},E}()}(li);var fi=Xn(li.exports);let Di=e.resolve();function di(){let e={},r=Ee(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},"fnTableTags");Kr(r)||(r="tableTags.json"),r=`${Di}/${r}`;let n=Kn();function u(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),u=1;u<t;u++)r[u-1]=arguments[u];setTimeout((()=>{n.emit(e,...r)}),1)}function o(){let e={};try{if(t.existsSync(r)){let n=_n(t.readFileSync(r,"utf8"));Zr(n)&&(e=n)}}catch(e){u("error",{msg:"readTableTags catch",err:e})}return e}function i(){try{let n=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(wn(e))return"";let r="";try{r=t?JSON.stringify(e,null,2):JSON.stringify(e)}catch(e){r=""}return r}(e);t.writeFileSync(r,n,"utf8")}catch(e){u("error",{msg:"writeTableTags catch",err:e})}}let a=Xo((()=>{i(),u("changeTableTags",e)}),200);return n.readTableTags=o,n.writeTableTags=i,n.initTableTags=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"useInputFirst";e="useStorageFirst"===r?ci(t,o()):"useInputOnly"===r?t:"useStorageOnly"===r?o():ci(o(),t),i()},n.setTableTags=function(){e=ci(e,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),i()},n.getTableTags=function(){return e},n.updateTableTag=function(t){e[t]=function(){if(!On(fi))throw new Error("invalid dayjs");return fi().format("YYYY-MM-DDTHH:mm:ssZ")}()+"|"+Ho(6),a()},n}function pi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Kn(),r=Ee(e,"instWConverServer",null);if(null===r)return t.emit("error","invalid opt.instWConverServer"),t;let n=Ee(e,"dbORMs",null);if(!Xr(n))return t.emit("error","invalid opt.dbORMs"),t;let u=Ee(e,"tableNames",null);if(!En(u))return t.emit("error","invalid opt.tableNames"),t;0===Yr(u)&&console.log("opt.tableNames.lenght = 0");let o=Ee(e,"fnTableTags",null);Kr(o)||(o="tableTags.json");let i=new di({fnTableTags:o});u=lo(u);let a={};function s(e){let t={};return lt(u,(r=>{let n=r,u=e[r];t[n]=u})),t}return lt(u,(e=>{a[e]=Ho(6)})),i.initTableTags(a,"useInputOnly"),lt(u,(e=>{let t=n[e];if(!t)throw new Error(`invalid dbORMs.${e}`);t.on("change",(()=>{i.updateTableTag(e)}))})),r.on("clientEnter",(function(e,t){r.deliver(e,{mode:"syncTable",data:i.readTableTags()})})),i.on("changeTableTags",(e=>{r.broadcast({mode:"syncTable",data:s(e)})})),i}function hi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function gi(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hi(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}let vi={},mi=null;async function Ai(e){let{func:t,input:r,pm:n}=e,u="";if(!Mn(r,"__sysToken__"))return n.resolve({state:"error",msg:"invalid token"}),n;if(u=function(e){if(!Kr(e)&&!hn(e)&&!w(e))return"";let t="";try{t=String(e)}catch(e){}try{t=e.toString()}catch(e){}return t}(r.__sysToken__),!Mn(r,"__sysInputArgs__"))return n.resolve({state:"error",msg:"invalid input"}),n;r=r.__sysInputArgs__;let o="",i=mi(u);if(o=xn(i)?await i:i,Kr(o)||(o=""),"getFuncList"===t){let e={state:"success",msg:it(vi)};return n.resolve(e),n}if(!Mn(vi,t))return n.resolve({state:"error",msg:`invalid func[${t}]`}),n;let a=vi[t];try{let e=await In(a)(o,...r);n.resolve(e)}catch(e){n.resolve({state:"error",msg:`無法識別func: ${t}`})}return n}function yi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Kn(),r=Ee(e,"instWConverServer",null);if(null===r)return t.emit("error","invalid opt.instWConverServer"),t;mi=Ee(e,"cbGetUserIDFromToken",null),On(mi)||(mi=async()=>"");let n=Ee(e,"useDbORM",null);Yn(n)||(n=!0);let u=null;if(n&&(u=Ee(e,"operORM",null),!On(u)))return t.emit("error","invalid opt.operORM when useDbORM=true"),t;let o=[];if(n&&(o=Ee(e,"tableNames",null),!En(o)))return t.emit("error","invalid opt.tableNames when useDbORM=true"),t;let i=[];n&&(i=Ee(e,"methods",null),En(i)||(i=["select","insert","save","del"]));let a=Ee(e,"extFuncs",null),s=Ee(e,"hookBefores",null),c=Ee(e,"hookAfters",null),l={};return n&&(o=lo(o),l=function(e,t,r){let n={};return lt(e,(e=>{lt(t,(t=>{n[`${e}.${t}`]=async function(n,u){return await r(n,e,t,u)}}))})),n}(o,i,u)),Xr(a)&&lt(a,((e,t)=>{l[t]=e})),vi=l,r.on("execute",(async function(e,r,n){let u={func:e,input:r,pm:n};if(On(s))try{s(u)}catch(e){t.emit("error",e)}else Sn(s)&&lt(s,(e=>{if(On(e))try{e(u)}catch(e){t.emit("error",e)}}));let o=await Ai(u).catch((e=>{t.emit("error",e)})),i=gi(gi({},u),{},{output:o});if(On(c))try{c(i)}catch(e){t.emit("error",e)}else Sn(c)&&lt(c,(e=>{if(On(e))try{e(i)}catch(e){t.emit("error",e)}}))})),t}function Ci(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=null,r=null,n=Kn(),u=Ee(e,"instWConverServer",null);if(null===u)return n.emit("error","invalid opt.instWConverServer"),n;let o=Ee(e,"useDbORM",null);Yn(o)||(o=!0);let i=Ee(e,"dbORMs",null),a=Ee(e,"operORM",null),s=Ee(e,"tableNamesExec",null),c=Ee(e,"methodsExec",null),l=Ee(e,"tableNamesSync",null),f=Ee(e,"cbGetUserIDFromToken",null),D=Ee(e,"extFuncs",null),d=Ee(e,"hookBefores",null),p=Ee(e,"hookAfters",null),h=Ee(e,"fnTableTags",null);if(t=new yi({instWConverServer:u,cbGetUserIDFromToken:f,useDbORM:o,operORM:a,tableNames:s,methods:c,extFuncs:D,hookBefores:d,hookAfters:p}),t.on("error",(e=>{n.emit("error",e)})),o){if(!Xr(i))return n.emit("error","invalid opt.dbORMs when useDbORM=true"),n;r=new pi({instWConverServer:u,dbORMs:i,tableNames:l,fnTableTags:h}),r.on("error",(e=>{n.emit("error",e)}))}return n.getInstWServWebdataServerExec=()=>t,n.getInstWServWebdataServerSync=()=>r,n}function Fi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=null,u=null,o=null,i=Kn(),a=Ee(e,"port");vn(a)||(a=8080);let s=Ee(e,"useCors");Yn(s)||(s=!0);let c=Ee(e,"useInert");Yn(c)||(c=!0);let l=Ee(e,"pathStaticFiles");Kr(l)||(l="dist");let f=Ee(e,"apis");Sn(f)||(f=[]);let D=Ee(e,"getUserIDFromToken",null),d=Ee(e,"useDbORM",null);Yn(d)||(d=!0);let p=Ee(e,"dbORMs",null),h=Ee(e,"operORM",null),g=Ee(e,"tableNamesExec",null),v=Ee(e,"methodsExec",null),m=Ee(e,"tableNamesSync",null),A=Ee(e,"extFuncs",null),y=Ee(e,"hookBefores",null),C=Ee(e,"hookAfters",null),F=Ee(e,"fnTableTags",null),b=Ee(e,"showLog");Yn(b)||(b=!0);return(async()=>{await(async()=>{t=new r.Server({port:a,routes:{cors:s}}),c&&await t.register(n);let e=[];c&&(e=[{method:"GET",path:"/{file*}",handler:{directory:{path:`${l}/`}}}]),e=[...e,...f],t.route(e)})(),await(async()=>{u=new Go({serverHapi:t}),u.on("open",(function(){b&&console.log(`Server[port:${a}]: open`)})),u.on("error",(function(e){b&&console.log(`Server[port:${a}]: error`,e),i.emit("error",{mode:"instWConverhpServer error",err:e})})),u.on("clientChange",(function(e){b&&console.log(`Server[port:${a}]: now clients: ${e}`)}))})(),await(async()=>{o=new Ci({instWConverServer:u,cbGetUserIDFromToken:D,useDbORM:d,dbORMs:p,operORM:h,tableNamesExec:g,tableNamesSync:m,methodsExec:v,extFuncs:A,hookBefores:y,hookAfters:C,fnTableTags:F}),o.on("error",(e=>{b&&console.log("error",e),i.emit("error",{mode:"instWServWebdataServer error",err:e})}))})(),await t.start(),b&&console.log(`Server running at: ${t.info.uri}`)})(),process.on("unhandledRejection",(e=>{console.log("unhandledRejection",e),i.emit("error",{mode:"unhandledRejection",err:e})})),process.on("uncaughtException",(e=>{console.log("uncaughtException",e),i.emit("error",{mode:"uncaughtException",err:e})})),i.getServer=()=>t,i.getInstWConverhpServer=()=>u,i.getInstWServWebdataServer=()=>o,i}function bi(e,t,r){var n=-1,u=e.length;t<0&&(t=-t>u?0:u+t),(r=r>u?u:r)<0&&(r+=u),u=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(u);++n<u;)o[n]=e[n+t];return o}function Ei(e){return e!=e}function wi(e,t,r){return t==t?function(e,t,r){for(var n=r-1,u=e.length;++n<u;)if(e[n]===t)return n;return-1}(e,t,r):Ln(e,Ei,r)}var Bi="\\ud800-\\udfff",ji="["+Bi+"]",Si="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Oi="\\ud83c[\\udffb-\\udfff]",xi="[^"+Bi+"]",_i="(?:\\ud83c[\\udde6-\\uddff]){2}",Ti="[\\ud800-\\udbff][\\udc00-\\udfff]",ki="(?:"+Si+"|"+Oi+")"+"?",Pi="[\\ufe0e\\ufe0f]?",Ii=Pi+ki+("(?:\\u200d(?:"+[xi,_i,Ti].join("|")+")"+Pi+ki+")*"),Ni="(?:"+[xi+Si+"?",Si,_i,Ti,ji].join("|")+")",$i=RegExp(Oi+"(?="+Oi+")|"+Ni+Ii,"g");function Mi(e){return Tr(e)?function(e){return e.match($i)||[]}(e):function(e){return e.split("")}(e)}function Ui(e,t,r){if((e=Ae(e))&&(r||void 0===t))return rn(e);if(!e||!(t=me(t)))return e;var n=Mi(e),u=Mi(t),o=function(e,t){for(var r=-1,n=e.length;++r<n&&wi(t,e[r],0)>-1;);return r}(n,u),i=function(e,t){for(var r=e.length;r--&&wi(t,e[r],0)>-1;);return r}(n,u)+1;return function(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&r>=n?e:bi(e,t,r)}(n,o,i).join("")}function Ri(e,t){let r=Pn();if(!En(e)&&!Xr(e))return r.reject("rs is not an array or object"),r;let n=!1;if(Xr(e)){n=!0;let t=[];lt(e,((e,r)=>{t.push({k:r,v:e})})),e=t}On(t)||(t=function(e){return e});let u=-1,o=[];return e.reduce((function(e,r){return e.then((function(e){o.push(e),u+=1;let i=u,a=r;return n&&(i=r.k,a=r.v),On(t)?t(a,i):a}))}),Promise.resolve()).then((function(e){var t,n,u,i;o.push(e),i=null==(t=o)?0:t.length,o=i?bi(t,(n=u||void 0===n?1:dn(n))<0?0:n,i):[],r.resolve(o)})).catch((function(e){r.reject(e)})),r}let Li={backup:async function(e){return await Ri(e,(async(e,t)=>(console.log("backup...",t),{name:t,data:await e.select()})))},recover:async function(e,r,n){let u=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!Nn(e))throw console.log("fp",e),new Error("fp is not exist");if(!Zr(r))throw console.log("woItems",r),new Error("invalid woItems");On(n)||(n=null),Yn(u)||(u=!1);let o=t.readFileSync(e,"utf8");o=Ui(o);let i=_n(o);On(n)&&n(),await Ri(i,(async e=>{console.log("recover...",e.name),u&&(console.log("needCreateStorage"),await r[e.name].createStorage());let t=null;return Yr(e.data)>0&&(t=await r[e.name].insert(e.data)),t}))}};function Gi(){if(!On(fi))throw new Error("invalid dayjs");return fi().format("YYYY-MM-DDTHH:mm:ss.SSSZ")}var Wi={exports:{}},zi={},Hi={exports:{}},Vi={};function qi(){var e={"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1};return e}var Yi=/javascript\s*\:/gim;Vi.whiteList=qi(),Vi.getDefaultWhiteList=qi,Vi.onAttr=function(e,t,r){},Vi.onIgnoreAttr=function(e,t,r){},Vi.safeAttrValue=function(e,t){return Yi.test(t)?"":t};var Ji={indexOf:function(e,t){var r,n;if(Array.prototype.indexOf)return e.indexOf(t);for(r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1},forEach:function(e,t,r){var n,u;if(Array.prototype.forEach)return e.forEach(t,r);for(n=0,u=e.length;n<u;n++)t.call(r,e[n],n,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}};var Xi=function(e,t){";"!==(e=Ji.trimRight(e))[e.length-1]&&(e+=";");var r=e.length,n=!1,u=0,o=0,i="";function a(){if(!n){var r=Ji.trim(e.slice(u,o)),a=r.indexOf(":");if(-1!==a){var s=Ji.trim(r.slice(0,a)),c=Ji.trim(r.slice(a+1));if(s){var l=t(u,i.length,s,c,r);l&&(i+=l+"; ")}}}u=o+1}for(;o<r;o++){var s=e[o];if("/"===s&&"*"===e[o+1]){var c=e.indexOf("*/",o+2);if(-1===c)break;u=(o=c+1)+1,n=!1}else"("===s?n=!0:")"===s?n=!1:";"===s?n||a():"\n"===s&&a()}return Ji.trim(i)},Zi=Vi,Qi=Xi;function Ki(e){return null==e}function ea(e){(e=function(e){var t={};for(var r in e)t[r]=e[r];return t}(e||{})).whiteList=e.whiteList||Zi.whiteList,e.onAttr=e.onAttr||Zi.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||Zi.onIgnoreAttr,e.safeAttrValue=e.safeAttrValue||Zi.safeAttrValue,this.options=e}ea.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,r=t.whiteList,n=t.onAttr,u=t.onIgnoreAttr,o=t.safeAttrValue;return Qi(e,(function(e,t,i,a,s){var c=r[i],l=!1;if(!0===c?l=c:"function"==typeof c?l=c(a):c instanceof RegExp&&(l=c.test(a)),!0!==l&&(l=!1),a=o(i,a)){var f,D={position:t,sourcePosition:e,source:s,isWhite:l};return l?Ki(f=n(i,a,D))?i+":"+a:f:Ki(f=u(i,a,D))?void 0:f}}))};var ta=ea;!function(e,t){var r=Vi,n=ta;for(var u in(t=e.exports=function(e,t){return new n(t).process(e)}).FilterCSS=n,r)t[u]=r[u];"undefined"!=typeof window&&(window.filterCSS=e.exports)}(Hi,Hi.exports);var ra=Hi.exports,na={indexOf:function(e,t){var r,n;if(Array.prototype.indexOf)return e.indexOf(t);for(r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1},forEach:function(e,t,r){var n,u;if(Array.prototype.forEach)return e.forEach(t,r);for(n=0,u=e.length;n<u;n++)t.call(r,e[n],n,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(e){var t=/\s|\n|\t/.exec(e);return t?t.index:-1}},ua=ra.FilterCSS,oa=ra.getDefaultWhiteList,ia=na;function aa(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height","loading"],ins:["datetime"],kbd:[],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var sa=new ua;function ca(e){return e.replace(la,"&lt;").replace(fa,"&gt;")}var la=/</g,fa=/>/g,Da=/"/g,da=/&quot;/g,pa=/&#([a-zA-Z0-9]*);?/gim,ha=/&colon;?/gim,ga=/&newline;?/gim,va=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,ma=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,Aa=/u\s*r\s*l\s*\(.*/gi;function ya(e){return e.replace(Da,"&quot;")}function Ca(e){return e.replace(da,'"')}function Fa(e){return e.replace(pa,(function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))}))}function ba(e){return e.replace(ha,":").replace(ga," ")}function Ea(e){for(var t="",r=0,n=e.length;r<n;r++)t+=e.charCodeAt(r)<32?" ":e.charAt(r);return ia.trim(t)}function wa(e){return e=Ea(e=ba(e=Fa(e=Ca(e))))}function Ba(e){return e=ca(e=ya(e))}zi.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height","loading"],ins:["datetime"],kbd:[],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]},zi.getDefaultWhiteList=aa,zi.onTag=function(e,t,r){},zi.onIgnoreTag=function(e,t,r){},zi.onTagAttr=function(e,t,r){},zi.onIgnoreTagAttr=function(e,t,r){},zi.safeAttrValue=function(e,t,r,n){if(r=wa(r),"href"===t||"src"===t){if("#"===(r=ia.trim(r)))return"#";if("http://"!==r.substr(0,7)&&"https://"!==r.substr(0,8)&&"mailto:"!==r.substr(0,7)&&"tel:"!==r.substr(0,4)&&"data:image/"!==r.substr(0,11)&&"ftp://"!==r.substr(0,6)&&"./"!==r.substr(0,2)&&"../"!==r.substr(0,3)&&"#"!==r[0]&&"/"!==r[0])return""}else if("background"===t){if(va.lastIndex=0,va.test(r))return""}else if("style"===t){if(ma.lastIndex=0,ma.test(r))return"";if(Aa.lastIndex=0,Aa.test(r)&&(va.lastIndex=0,va.test(r)))return"";!1!==n&&(r=(n=n||sa).process(r))}return r=Ba(r)},zi.escapeHtml=ca,zi.escapeQuote=ya,zi.unescapeQuote=Ca,zi.escapeHtmlEntities=Fa,zi.escapeDangerHtml5Entities=ba,zi.clearNonPrintableCharacter=Ea,zi.friendlyAttrValue=wa,zi.escapeAttrValue=Ba,zi.onIgnoreTagStripAll=function(){return""},zi.StripTagBody=function(e,t){"function"!=typeof t&&(t=function(){});var r=!Array.isArray(e),n=[],u=!1;return{onIgnoreTag:function(o,i,a){if(function(t){return!!r||-1!==ia.indexOf(e,t)}(o)){if(a.isClosing){var s="[/removed]",c=a.position+10;return n.push([!1!==u?u:a.position,c]),u=!1,s}return u||(u=a.position),"[removed]"}return t(o,i,a)},remove:function(e){var t="",r=0;return ia.forEach(n,(function(n){t+=e.slice(r,n[0]),r=n[1]})),t+=e.slice(r)}}},zi.stripCommentTag=function(e){for(var t="",r=0;r<e.length;){var n=e.indexOf("\x3c!--",r);if(-1===n){t+=e.slice(r);break}t+=e.slice(r,n);var u=e.indexOf("--\x3e",n);if(-1===u)break;r=u+3}return t},zi.stripBlankChar=function(e){var t=e.split("");return(t=t.filter((function(e){var t=e.charCodeAt(0);return 127!==t&&(!(t<=31)||(10===t||13===t))}))).join("")},zi.attributeWrapSign='"',zi.cssFilter=sa,zi.getDefaultCSSWhiteList=oa;var ja={},Sa=na;function Oa(e){var t,r=Sa.spaceIndex(e);return t=-1===r?e.slice(1,-1):e.slice(1,r+1),"/"===(t=Sa.trim(t).toLowerCase()).slice(0,1)&&(t=t.slice(1)),"/"===t.slice(-1)&&(t=t.slice(0,-1)),t}function xa(e){return"</"===e.slice(0,2)}var _a=/[^a-zA-Z0-9\\_:.-]/gim;function Ta(e,t){for(;t<e.length;t++){var r=e[t];if(" "!==r)return"="===r?t:-1}}function ka(e,t){for(;t<e.length;t++){var r=e[t];if(" "!==r)return"'"===r||'"'===r?t:-1}}function Pa(e,t){for(;t>0;t--){var r=e[t];if(" "!==r)return"="===r?t:-1}}function Ia(e){return function(e){return'"'===e[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]}(e)?e.substr(1,e.length-2):e}ja.parseTag=function(e,t,r){var n="",u=0,o=!1,i=!1,a=0,s=e.length,c="",l="";e:for(a=0;a<s;a++){var f=e.charAt(a);if(!1===o){if("<"===f){o=a;continue}}else if(!1===i){if("<"===f){n+=r(e.slice(u,a)),o=a,u=a;continue}if(">"===f||a===s-1){n+=r(e.slice(u,o)),c=Oa(l=e.slice(o,a+1)),n+=t(o,n.length,c,l,xa(l)),u=a+1,o=!1;continue}if('"'===f||"'"===f)for(var D=1,d=e.charAt(a-D);""===d.trim()||"="===d;){if("="===d){i=f;continue e}d=e.charAt(a-++D)}}else if(f===i){i=!1;continue}}return u<s&&(n+=r(e.substr(u))),n},ja.parseAttr=function(e,t){var r=0,n=0,u=[],o=!1,i=e.length;function a(e,r){if(!((e=(e=Sa.trim(e)).replace(_a,"").toLowerCase()).length<1)){var n=t(e,r||"");n&&u.push(n)}}for(var s=0;s<i;s++){var c,l=e.charAt(s);if(!1!==o||"="!==l)if(!1===o||s!==n)if(/\s|\n|\t/.test(l)){if(e=e.replace(/\s|\n|\t/g," "),!1===o){if(-1===(c=Ta(e,s))){a(Sa.trim(e.slice(r,s))),o=!1,r=s+1;continue}s=c-1;continue}if(-1===(c=Pa(e,s-1))){a(o,Ia(Sa.trim(e.slice(r,s)))),o=!1,r=s+1;continue}}else;else{if(-1===(c=e.indexOf(l,s+1)))break;a(o,Sa.trim(e.slice(n+1,c))),o=!1,r=(s=c)+1}else o=e.slice(r,s),r=s+1,n='"'===e.charAt(r)||"'"===e.charAt(r)?r:ka(e,s+1)}return r<e.length&&(!1===o?a(e.slice(r)):a(o,Ia(Sa.trim(e.slice(r))))),Sa.trim(u.join(" "))};var Na=ra.FilterCSS,$a=zi,Ma=ja,Ua=Ma.parseTag,Ra=Ma.parseAttr,La=na;function Ga(e){return null==e}function Wa(e){(e=function(e){var t={};for(var r in e)t[r]=e[r];return t}(e||{})).stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=$a.onIgnoreTagStripAll),e.whiteList||e.allowList?e.whiteList=function(e){var t={};for(var r in e)Array.isArray(e[r])?t[r.toLowerCase()]=e[r].map((function(e){return e.toLowerCase()})):t[r.toLowerCase()]=e[r];return t}(e.whiteList||e.allowList):e.whiteList=$a.whiteList,this.attributeWrapSign=!0===e.singleQuotedAttributeValue?"'":$a.attributeWrapSign,e.onTag=e.onTag||$a.onTag,e.onTagAttr=e.onTagAttr||$a.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||$a.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||$a.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||$a.safeAttrValue,e.escapeHtml=e.escapeHtml||$a.escapeHtml,this.options=e,!1===e.css?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new Na(e.css))}Wa.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this,r=t.options,n=r.whiteList,u=r.onTag,o=r.onIgnoreTag,i=r.onTagAttr,a=r.onIgnoreTagAttr,s=r.safeAttrValue,c=r.escapeHtml,l=t.attributeWrapSign,f=t.cssFilter;r.stripBlankChar&&(e=$a.stripBlankChar(e)),r.allowCommentTag||(e=$a.stripCommentTag(e));var D=!1;r.stripIgnoreTagBody&&(D=$a.StripTagBody(r.stripIgnoreTagBody,o),o=D.onIgnoreTag);var d=Ua(e,(function(e,t,r,D,d){var p={sourcePosition:e,position:t,isClosing:d,isWhite:Object.prototype.hasOwnProperty.call(n,r)},h=u(r,D,p);if(!Ga(h))return h;if(p.isWhite){if(p.isClosing)return"</"+r+">";var g=function(e){var t=La.spaceIndex(e);if(-1===t)return{html:"",closing:"/"===e[e.length-2]};var r="/"===(e=La.trim(e.slice(t+1,-1)))[e.length-1];return r&&(e=La.trim(e.slice(0,-1))),{html:e,closing:r}}(D),v=n[r],m=Ra(g.html,(function(e,t){var n=-1!==La.indexOf(v,e),u=i(r,e,t,n);return Ga(u)?n?(t=s(r,e,t,f))?e+"="+l+t+l:e:Ga(u=a(r,e,t,n))?void 0:u:u}));return D="<"+r,m&&(D+=" "+m),g.closing&&(D+=" /"),D+=">"}return Ga(h=o(r,D,p))?c(D):h}),c);return D&&(d=D.remove(d)),d};var za=Wa;!function(e,t){var r=zi,n=ja,u=za;function o(e,t){return new u(t).process(e)}(t=e.exports=o).filterXSS=o,t.FilterXSS=u,function(){for(var e in r)t[e]=r[e];for(var u in n)t[u]=n[u]}(),"undefined"!=typeof window&&(window.filterXSS=e.exports),"undefined"!=typeof self&&"undefined"!=typeof DedicatedWorkerGlobalScope&&self instanceof DedicatedWorkerGlobalScope&&(self.filterXSS=e.exports)}(Wi,Wi.exports);var Ha=Xn(Wi.exports);function Va(e){let t=function e(t){return En(t)||Xr(t)?(lt(t,(function(r,n){t[n]=e(r)})),t):Kr(t)?Ha(t,{onIgnoreTagAttr:function(e,t,r,n){if("style"===t)return t+'="'+Ha.escapeAttrValue(r)+'"'}}):t}(lo(e));return t}let qa=null,Ya=null;function Ja(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"save";if(!Zr(qa))throw console.log("ds",qa),new Error("invalid ds");let u=qa[e].keys,o=!1;En(r)||(o=!0,r=[r]);let i=Gi();return n.indexOf("insert")>=0&&(u.indexOf("userId")>=0&&lt(r,((e,n)=>{r[n].userId=t})),u.indexOf("timeCreate")>=0&&lt(r,((e,t)=>{r[t].timeCreate=i})),u.indexOf("userIdUpdate")>=0&&lt(r,((e,n)=>{r[n].userIdUpdate=t})),u.indexOf("timeUpdate")>=0&&lt(r,((e,t)=>{r[t].timeUpdate=i}))),(n.indexOf("insert")>=0||n.indexOf("save")>=0)&&(u.indexOf("userIdUpdate")>=0&&lt(r,((e,n)=>{r[n].userIdUpdate=t})),u.indexOf("timeUpdate")>=0&&lt(r,((e,t)=>{r[t].timeUpdate=i}))),r=Sr(r,((e,t)=>{let r={};return lt(e,((e,t)=>{e=Va(e),r[t]=e})),r})),r=o?r[0]:r}async function Xa(e,t,r,n){let u,o=null;if(!Zr(Ya))return Promise.reject("無有效woItems");let i=Ee(Ya,t,null);if(null===i)return Promise.reject(`ORM找不到表名稱: ${t}`);if("select"===r){if(u=await i.select(n).catch((e=>{console.log(`${t}.select catch`,e),o="取得資料失敗"})),Kr(o))return Promise.reject(o)}else if("insert"===r||"save"===r){try{n=Ja(t,e,n,r)}catch(e){return console.log("adjustData catch",e.toString()),o="調整資料失敗",Promise.reject(o)}if("insert"===r?u=await i.insert(n).catch((e=>{console.log(`${t}.save catch`,e),o="新增資料失敗"})):"save"===r&&(u=await i.save(n,{atomic:!0}).catch((e=>{console.log(`${t}.save catch`,e),o="儲存資料失敗"}))),Kr(o))return Promise.reject(o);u=En(n)?Sr(n,(e=>({id:e.id}))):{id:n.id}}else if("del"===r)u=await i.del(n).catch((e=>{console.log(`${t}.del catch`,e),o="刪除資料失敗"}));else if("delAll"===r)u=await i.delAll(n).catch((e=>{console.log(`${t}.delAll catch`,e),o="刪除資料失敗"}));else if("mix"===r){if(!Zr(n))return Promise.reject("mix僅支援輸入ltdtDiffByKey結果物件");let r;u=[];let a=Ee(n,"add",[]);if(Yr(a)>0){try{a=Ja(t,e,a,"insert+save")}catch(e){return console.log("adjustData catch",e.toString()),o="調整資料失敗",Promise.reject(o)}if(await i.insert(a).catch((e=>{console.log(`${t}.save catch`,e),o="新增資料失敗"})),Kr(o))return Promise.reject(o);r=Sr(a,(e=>({id:e.id}))),u=[...u,...r]}let s=Ee(n,"del",[]);if(Yr(s)>0){if(await i.del(s).catch((e=>{console.log(`${t}.save catch`,e),o="刪除資料失敗"})),Kr(o))return Promise.reject(o);r=Sr(s,(e=>({id:e.id}))),u=[...u,...r]}let c=Ee(n,"diff",[]);if(Yr(c)>0){try{c=Ja(t,e,c)}catch(e){return console.log("adjustData catch",e.toString()),o="調整資料失敗",Promise.reject(o)}if(await i.save(c).catch((e=>{console.log(`${t}.save catch`,e),o="變更資料失敗"})),Kr(o))return Promise.reject(o);r=Sr(c,(e=>({id:e.id}))),u=[...u,...r]}}else o=`invalid mode: ${r}`;return Kr(o)?Promise.reject(o):u}function Za(e,t){return qa=e,Ya=t,Xa}function Qa(e,t){var r=[];return st(e,(function(e,n,u){t(e,n,u)&&r.push(e)})),r}function Ka(e,t){return(c(e)?Mt:Qa)(e,Br(t))}function es(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!En(e)){let e=Pn();return e.reject("pms is not an array"),e}return e.reduce(((e,t)=>e.then(t)),Promise.resolve(t))}let ts=[],rs=[],ns=[],us=null,os=null,is=!0,as=!0;function ss(e){setTimeout((()=>{ts.push(e)}),1)}function cs(e){setTimeout((()=>{rs.push(e)}),1)}function ls(e){setTimeout((()=>{ns.push(e)}),1)}async function fs(e,t,r,n){if(!On(us))return Promise.reject("invalid mapOrm");if(is&&!Kr(e))return console.log("userId",e),console.log("找不到使用者主鍵"),Promise.reject("找不到使用者主鍵");let u="n";if(is){if(!On(os))return Promise.reject("invalid getUserById");let t=await os(e);if(!t)return console.log("userId",e),console.log("找不到使用者資訊"),Promise.reject("找不到使用者資訊");u=Ee(t,"isAdmin"),"y"!==u&&"n"!==u&&(u="n");let r=Ee(t,"isActive");if("y"!==r&&"n"!==r&&(r="n"),"y"!==r)return console.log("userId",e),console.log("oSelf",t),console.log("使用者被停權或無有效使用者資訊"),Promise.reject("使用者被停權或無有效使用者資訊")}if(await Ri(ts,(o=>o({woName:t,userId:e,isAdmin:u,mode:r,input:n}))),Yr(rs)>0){let o={woName:t,userId:e,isAdmin:u,mode:r,input:n},i=await es(rs,o);n=i.input}let o=await us(e,t,r,n);return as&&"n"===u&&"select"===r&&En(o)&&(o=Ka(o,(e=>!Mn(e,"isActive")||!("n"===e.isActive)))),Yr(ns)>0&&(o=await es(ns,{woName:t,userId:e,isAdmin:u,mode:r,input:n,output:o})),o}function Ds(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ds(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ds(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ds(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ps(e,t,r,n){let u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=function(e,t,r,n){if(!Zr(e))throw console.log("ds",e),new Error("invalid ds");if(!On(t))throw console.log("WOrm",t),new Error("invalid WOrm");if(!Kr(r))throw console.log("url",r),new Error("invalid url");if(!Kr(n))throw console.log("db",n),new Error("invalid db");let u={};return lt(it(e),(e=>{let o=new t({url:r,db:n,cl:e});u[e]=o})),u}(e,t,r,n),i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return On(e)?(us=e,is=Ee(t,"bCheckUser"),Yn(is)||(is=!0),os=Ee(t,"getUserById"),as=Ee(t,"bExcludeWhenNotAdmin"),Yn(as)||(as=!0),{addFunCheck:ss,addFunPreProcessing:cs,addFunPostProcessing:ls,procOrm:fs}):Promise.reject("invalid mapOrm")}(Za(e,o),u);return ds(ds({},Li),{},{woItems:o},i)}function hs(e,t){if(!Xr(e))return{};if(!Sn(t))return{};let r={};return lt(t,(function(t){Mn(e,t)&&(r[t]=Ee(e,t))})),r}function gs(){if(!On(fi))throw new Error("invalid dayjs");return fi().format("YYYYMMDDHHmmss")}let vs="grups",ms={id:{pk:!0,name:"主鍵",type:"STRING"},order:{name:"順序",type:"INTEGER"},name:{name:"名稱",type:"STRING"},description:{name:"說明",type:"TEXT"},from:{name:"來源",type:"STRING"},cpemis:{name:"權限清單",type:"TEXT"},userId:{name:"創建使用者主鍵",type:"STRING"},timeCreate:{name:"創建時間",type:"STRING"},userIdUpdate:{name:"最新變更使用者主鍵",type:"STRING"},timeUpdate:{name:"更新時間",type:"STRING"}},As=function(){let e=Hn(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},it(ms));return e.id=`${gs()}-${Ho()}`,e.userIdUpdate=e.userId,e.timeCreate=Gi(),e.userIdUpdate=e.userId,e.timeUpdate=e.timeCreate,e},ys="pemis",Cs={id:{pk:!0,name:"主鍵",type:"STRING"},order:{name:"順序",type:"INTEGER"},name:{name:"名稱",type:"STRING"},description:{name:"說明",type:"TEXT"},from:{name:"來源",type:"STRING"},crules:{name:"管控對象清單",type:"TEXT"},userId:{name:"創建使用者主鍵",type:"STRING"},timeCreate:{name:"創建時間",type:"STRING"},userIdUpdate:{name:"最新變更使用者主鍵",type:"STRING"},timeUpdate:{name:"更新時間",type:"STRING"}},Fs=function(){let e=Hn(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},it(Cs));return e.id=`${gs()}-${Ho()}`,e.userIdUpdate=e.userId,e.timeCreate=Gi(),e.userIdUpdate=e.userId,e.timeUpdate=e.timeCreate,e},bs="targets",Es={id:{pk:!0,name:"主鍵",type:"STRING"},order:{name:"順序",type:"INTEGER"},description:{name:"說明",type:"TEXT"},from:{name:"來源",type:"STRING"},userId:{name:"創建使用者主鍵",type:"STRING"},timeCreate:{name:"創建時間",type:"STRING"},userIdUpdate:{name:"最新變更使用者主鍵",type:"STRING"},timeUpdate:{name:"更新時間",type:"STRING"}},ws=function(){let e=Hn(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},it(Es));return e.id=`${gs()}-${Ho()}`,e.userIdUpdate=e.userId,e.timeCreate=Gi(),e.userIdUpdate=e.userId,e.timeUpdate=e.timeCreate,e},Bs="users",js={id:{pk:!0,name:"主鍵",type:"STRING"},order:{name:"順序",type:"INTEGER"},name:{name:"姓名",type:"STRING"},email:{name:"電子郵件",type:"STRING"},description:{name:"描述",type:"TEXT"},from:{name:"來源",type:"STRING"},cgrups:{name:"權限群組清單",type:"TEXT"},isAdmin:{name:"是否為系統管理員",type:"STRING"},userId:{name:"創建使用者主鍵",type:"STRING"},timeCreate:{name:"創建時間",type:"STRING"},userIdUpdate:{name:"最新變更使用者主鍵",type:"STRING"},timeUpdate:{name:"更新時間",type:"STRING"},isActive:{name:"是否有效",type:"STRING"}},Ss=function(){let e=Hn(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},it(js));return e.id=`${gs()}-${Ho()}`,e.isAdmin="n",e.userIdUpdate=e.userId,e.timeCreate=Gi(),e.userIdUpdate=e.userId,e.timeUpdate=e.timeCreate,e.isActive="y",e};function Os(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function xs(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Os(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Os(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _s(e){let t=Ee(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"useCreateStorage");Yn(t)||(t=!1);let{keyTable:r,tableNameCht:n,tableNameEng:u,settings:o,parser:i,funNew:a,funTest:s,ext:c}=e;if(!Kr(r))throw new Error(`invalid keyTable[${r}]`);if(Kr(n)||(n=r),Kr(u)||(u=r),!Zr(o))throw new Error("invalid settings");Zr(c)||(c=null),Zr(i)||(i=null),On(a)||(a=null);let l=null;On(s)&&(l=async e=>{if(!Zr(e))throw new Error("invalid wo");if(!Mn(e,r))throw console.log(e),new Error(`keyTable[${r}] is not in wo`);let n=[];try{n=s(),xn(n)&&(n=await n)}catch(e){throw console.log(`keyTable[${r}] funTest catch`,e),new Error(e)}if(0!==Yr(n))return t&&await e[r].createStorage(),await e[r].save(n),n});let f={},D={};return lt(it(o),(e=>{let t=Ee(o,`${e}.name`,"");Kr(t)&&(f[e]=t);let r=Ee(o,`${e}.type`,"");Kr(r)&&(D[e]=r)})),xs(xs({},e),{},{keyTable:r,tableNameCht:n,tableNameEng:u,settings:o,keys:it(o),kpType:D,kpHead:f,parser:i,funNew:a,funTest:s,funTestAndSave:l,ext:c})}let Ts={grups:{keyTable:vs,tableNameCht:"權限群組設定",tableNameEng:"Permission groups",settings:ms,funNew:As,funTest:()=>{let e=[["權限群組M1","\n            {\n                '權限P1': {\n                    'mode': 'OR',\n                    'isActive': 'y',\n                },\n                '權限P2': {\n                    'mode': 'OR',\n                    'isActive': 'y',\n                },\n            }\n        "],["權限群組M2","\n            {\n                '權限P2': {\n                    'mode': 'OR',\n                    'isActive': 'y',\n                },\n                '權限P3': {\n                    'mode': 'OR',\n                    'isActive': 'y',\n                },\n            }\n        "],["權限群組M3","\n            {\n                '權限P2': {\n                    'mode': 'OR',\n                    'isActive': 'y',\n                },\n                '權限P3': {\n                    'mode': 'AND',\n                    'isActive': 'y',\n                },\n            }\n        "],["權限群組M4","\n            {\n                '權限P3': {\n                    'mode': 'OR',\n                    'isActive': 'y',\n                },\n                '權限P4': {\n                    'mode': 'OR',\n                    'isActive': 'y',\n                },\n            }\n        "]];return e=Sr(e,((e,t)=>{let[r,n]=e,u=As({userId:"id-for-admin",order:t,name:r,description:`${r}的說明`,cpemis:n});return u.id=`id-for-${r}`,u=hs(u,it(ms)),u})),console.log(`已產生: ${vs} 測試資料`,e),e}},pemis:{keyTable:ys,tableNameCht:"權限設定",tableNameEng:"Permissions",settings:Cs,funNew:Fs,funTest:()=>{let e=[["權限P1","{  \"專案A/頁A/區塊A\": 'y', \"專案A/頁B/區塊A\": 'n', \"專案A/頁C\": 'n' }"],["權限P2","{  \"專案A/頁C\": 'y', \"專案B/頁A/區塊A\": 'y', \"專案B/頁A/區塊B\": 'y' }"],["權限P3","{  \"專案A/頁C\": 'y', \"專案B/頁A/區塊A\": 'n', \"專案B/頁A/區塊B\": 'y', \"專案B/頁A/區塊C\": 'y' }"],["權限P4","{  \"專案B/頁B/區塊A/待辦事項清單\": 'y', \"專案B/頁B/區塊B/顯示後台按鈕\": 'n' }"]];return e=Sr(e,((e,t)=>{let[r,n]=e,u=Fs({userId:"id-for-admin",order:t,name:r,description:`${r}的說明`,crules:n});return u.id=`id-for-${r}`,u=hs(u,it(Cs)),u})),console.log(`已產生: ${ys} 測試資料`,e),e}},targets:{keyTable:bs,tableNameCht:"管控對象",tableNameEng:"Targets",settings:Es,funNew:ws,funTest:()=>{let e=["專案A/頁A/區塊A","專案A/頁A/區塊A/執行按鈕","專案A/頁A/區塊A/分析按鈕","專案A/頁B/區塊A","專案A/頁B/區塊A/執行按鈕","專案A/頁B/區塊A/分析按鈕","專案A/頁B/區塊B/展開按鈕","專案A/頁B/區塊B/下載按鈕","專案A/頁C","專案B/頁A/區塊A","專案B/頁A/區塊A/顯示綜合報表","專案B/頁A/區塊A/顯示當前數據","專案B/頁A/區塊B","專案B/頁A/區塊B/下載報表按鈕","專案B/頁A/區塊B/下載數據按鈕","專案B/頁A/區塊C","專案B/頁B/區塊A","專案B/頁B/區塊A/待辦事項清單","專案B/頁B/區塊A/相關資源清單","專案B/頁B/區塊B","專案B/頁B/區塊B/顯示後台按鈕","專案B/頁B/區塊B/轉跳主站按鈕"];return e=Sr(e,((e,t)=>{let r=ws({userId:"id-for-admin",order:t,description:`${e}的說明`});return r.id=e,r=hs(r,it(Es)),r})),console.log(`已產生: ${bs} 測試資料`,e),e}},users:{keyTable:Bs,tableNameCht:"使用者",tableNameEng:"Users",settings:js,funNew:Ss,funTest:()=>{let e=[["peter","teamA","\n            { \n                '權限群組M1': {\n                    'mode': 'OR',\n                    'isActive': 'y',\n                }\n            }\n        ","n"],["mary","teamA","\n            { \n                '權限群組M2': {\n                    'mode': 'OR',\n                    'isActive': 'y',\n                }\n            }\n        ","n"],["john","teamA","\n            { \n                '權限群組M3': {\n                    'mode': 'OR',\n                    'isActive': 'y',\n                }\n            }\n        ","n"],["admin","","\n            { \n                '權限群組M4': {\n                    'mode': 'OR',\n                    'isActive': 'y',\n                }\n            }\n        ","y"]];return e=Sr(e,((e,t)=>{let[r,n,u,o]=e,i=Ss({userId:"id-for-admin",order:t,name:r,email:`${r}@example.com`,from:n,cgrups:u,isAdmin:o});return i.id=`id-for-${r}`,"john"===r&&(i.email=`${i.email};john@test.com`),i.isAdmin=o,i=hs(i,it(js)),i})),console.log(`已產生: ${Bs} 測試資料`,e),e}}},ks={};for(let e in Ts)ks[e]=_s(Ts[e],{useCreateStorage:!1});var Ps={exports:{}};!function(e,t){e.exports=function(){function e(e,t){return e(t={exports:{}},t.exports),t.exports}var t=e((function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)})),r=e((function(e){var t=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=t)}));r.version;var n=function(e){return"object"==typeof e?null!==e:"function"==typeof e},u=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e},o=function(e){try{return!!e()}catch(e){return!0}},i=!o((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),a=t.document,s=n(a)&&n(a.createElement),c=function(e){return s?a.createElement(e):{}},l=!i&&!o((function(){return 7!=Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a})),f=function(e,t){if(!n(e))return e;var r,u;if(t&&"function"==typeof(r=e.toString)&&!n(u=r.call(e)))return u;if("function"==typeof(r=e.valueOf)&&!n(u=r.call(e)))return u;if(!t&&"function"==typeof(r=e.toString)&&!n(u=r.call(e)))return u;throw TypeError("Can't convert object to primitive value")},D=Object.defineProperty,d=i?Object.defineProperty:function(e,t,r){if(u(e),t=f(t,!0),u(r),l)try{return D(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e},p={f:d},h=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},g=i?function(e,t,r){return p.f(e,t,h(1,r))}:function(e,t,r){return e[t]=r,e},v={}.hasOwnProperty,m=function(e,t){return v.call(e,t)},A=0,y=Math.random(),C=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++A+y).toString(36))},F=e((function(e){var n="__core-js_shared__",u=t[n]||(t[n]={});(e.exports=function(e,t){return u[e]||(u[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})})),b=F("native-function-to-string",Function.toString),E=e((function(e){var n=C("src"),u="toString",o=(""+b).split(u);r.inspectSource=function(e){return b.call(e)},(e.exports=function(e,r,u,i){var a="function"==typeof u;a&&(m(u,"name")||g(u,"name",r)),e[r]!==u&&(a&&(m(u,n)||g(u,n,e[r]?""+e[r]:o.join(String(r)))),e===t?e[r]=u:i?e[r]?e[r]=u:g(e,r,u):(delete e[r],g(e,r,u)))})(Function.prototype,u,(function(){return"function"==typeof this&&this[n]||b.call(this)}))})),w=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},B=function(e,t,r){if(w(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,u){return e.call(t,r,n,u)}}return function(){return e.apply(t,arguments)}},j="prototype",S=function(e,n,u){var o,i,a,s,c=e&S.F,l=e&S.G,f=e&S.S,D=e&S.P,d=e&S.B,p=l?t:f?t[n]||(t[n]={}):(t[n]||{})[j],h=l?r:r[n]||(r[n]={}),v=h[j]||(h[j]={});for(o in l&&(u=n),u)a=((i=!c&&p&&void 0!==p[o])?p:u)[o],s=d&&i?B(a,t):D&&"function"==typeof a?B(Function.call,a):a,p&&E(p,o,a,e&S.U),h[o]!=a&&g(h,o,s),D&&v[o]!=a&&(v[o]=a)};t.core=r,S.F=1,S.G=2,S.S=4,S.P=8,S.B=16,S.W=32,S.U=64,S.R=128;var O,x=S,_=Math.ceil,T=Math.floor,k=function(e){return isNaN(e=+e)?0:(e>0?T:_)(e)},P=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},I=(O=!1,function(e,t){var r,n,u=String(P(e)),o=k(t),i=u.length;return o<0||o>=i?O?"":void 0:(r=u.charCodeAt(o))<55296||r>56319||o+1===i||(n=u.charCodeAt(o+1))<56320||n>57343?O?u.charAt(o):r:O?u.slice(o,o+2):n-56320+(r-55296<<10)+65536});x(x.P,"String",{codePointAt:function(e){return I(this,e)}}),r.String.codePointAt;var N=Math.max,$=Math.min,M=function(e,t){return(e=k(e))<0?N(e+t,0):$(e,t)},U=String.fromCharCode,R=String.fromCodePoint;x(x.S+x.F*(!!R&&1!=R.length),"String",{fromCodePoint:function(e){for(var t,r=arguments,n=[],u=arguments.length,o=0;u>o;){if(t=+r[o++],M(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?U(t):U(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}}),r.String.fromCodePoint;var L,G,W,z,H,V,q,Y,J,X,Z,Q,K,ee,te={Space_Separator:/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,ID_Start:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,ID_Continue:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/},re={isSpaceSeparator:function(e){return"string"==typeof e&&te.Space_Separator.test(e)},isIdStartChar:function(e){return"string"==typeof e&&(e>="a"&&e<="z"||e>="A"&&e<="Z"||"$"===e||"_"===e||te.ID_Start.test(e))},isIdContinueChar:function(e){return"string"==typeof e&&(e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9"||"$"===e||"_"===e||"‌"===e||"‍"===e||te.ID_Continue.test(e))},isDigit:function(e){return"string"==typeof e&&/[0-9]/.test(e)},isHexDigit:function(e){return"string"==typeof e&&/[0-9A-Fa-f]/.test(e)}},ne=function(e,t){L=String(e),G="start",W=[],z=0,H=1,V=0,q=void 0,Y=void 0,J=void 0;do{q=oe(),pe[G]()}while("eof"!==q.type);return"function"==typeof t?ue({"":J},"",t):J};function ue(e,t,r){var n=e[t];if(null!=n&&"object"==typeof n)if(Array.isArray(n))for(var u=0;u<n.length;u++){var o=String(u),i=ue(n,o,r);void 0===i?delete n[o]:Object.defineProperty(n,o,{value:i,writable:!0,enumerable:!0,configurable:!0})}else for(var a in n){var s=ue(n,a,r);void 0===s?delete n[a]:Object.defineProperty(n,a,{value:s,writable:!0,enumerable:!0,configurable:!0})}return r.call(e,t,n)}function oe(){for(X="default",Z="",Q=!1,K=1;;){ee=ie();var e=se[X]();if(e)return e}}function ie(){if(L[z])return String.fromCodePoint(L.codePointAt(z))}function ae(){var e=ie();return"\n"===e?(H++,V=0):e?V+=e.length:V++,e&&(z+=e.length),e}var se={default:function(){switch(ee){case"\t":case"\v":case"\f":case" ":case" ":case"\ufeff":case"\n":case"\r":case"\u2028":case"\u2029":return void ae();case"/":return ae(),void(X="comment");case void 0:return ae(),ce("eof")}if(!re.isSpaceSeparator(ee))return se[G]();ae()},comment:function(){switch(ee){case"*":return ae(),void(X="multiLineComment");case"/":return ae(),void(X="singleLineComment")}throw ve(ae())},multiLineComment:function(){switch(ee){case"*":return ae(),void(X="multiLineCommentAsterisk");case void 0:throw ve(ae())}ae()},multiLineCommentAsterisk:function(){switch(ee){case"*":return void ae();case"/":return ae(),void(X="default");case void 0:throw ve(ae())}ae(),X="multiLineComment"},singleLineComment:function(){switch(ee){case"\n":case"\r":case"\u2028":case"\u2029":return ae(),void(X="default");case void 0:return ae(),ce("eof")}ae()},value:function(){switch(ee){case"{":case"[":return ce("punctuator",ae());case"n":return ae(),le("ull"),ce("null",null);case"t":return ae(),le("rue"),ce("boolean",!0);case"f":return ae(),le("alse"),ce("boolean",!1);case"-":case"+":return"-"===ae()&&(K=-1),void(X="sign");case".":return Z=ae(),void(X="decimalPointLeading");case"0":return Z=ae(),void(X="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return Z=ae(),void(X="decimalInteger");case"I":return ae(),le("nfinity"),ce("numeric",1/0);case"N":return ae(),le("aN"),ce("numeric",NaN);case'"':case"'":return Q='"'===ae(),Z="",void(X="string")}throw ve(ae())},identifierNameStartEscape:function(){if("u"!==ee)throw ve(ae());ae();var e=de();switch(e){case"$":case"_":break;default:if(!re.isIdStartChar(e))throw Ae()}Z+=e,X="identifierName"},identifierName:function(){switch(ee){case"$":case"_":case"‌":case"‍":return void(Z+=ae());case"\\":return ae(),void(X="identifierNameEscape")}if(!re.isIdContinueChar(ee))return ce("identifier",Z);Z+=ae()},identifierNameEscape:function(){if("u"!==ee)throw ve(ae());ae();var e=de();switch(e){case"$":case"_":case"‌":case"‍":break;default:if(!re.isIdContinueChar(e))throw Ae()}Z+=e,X="identifierName"},sign:function(){switch(ee){case".":return Z=ae(),void(X="decimalPointLeading");case"0":return Z=ae(),void(X="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return Z=ae(),void(X="decimalInteger");case"I":return ae(),le("nfinity"),ce("numeric",K*(1/0));case"N":return ae(),le("aN"),ce("numeric",NaN)}throw ve(ae())},zero:function(){switch(ee){case".":return Z+=ae(),void(X="decimalPoint");case"e":case"E":return Z+=ae(),void(X="decimalExponent");case"x":case"X":return Z+=ae(),void(X="hexadecimal")}return ce("numeric",0*K)},decimalInteger:function(){switch(ee){case".":return Z+=ae(),void(X="decimalPoint");case"e":case"E":return Z+=ae(),void(X="decimalExponent")}if(!re.isDigit(ee))return ce("numeric",K*Number(Z));Z+=ae()},decimalPointLeading:function(){if(re.isDigit(ee))return Z+=ae(),void(X="decimalFraction");throw ve(ae())},decimalPoint:function(){switch(ee){case"e":case"E":return Z+=ae(),void(X="decimalExponent")}return re.isDigit(ee)?(Z+=ae(),void(X="decimalFraction")):ce("numeric",K*Number(Z))},decimalFraction:function(){switch(ee){case"e":case"E":return Z+=ae(),void(X="decimalExponent")}if(!re.isDigit(ee))return ce("numeric",K*Number(Z));Z+=ae()},decimalExponent:function(){switch(ee){case"+":case"-":return Z+=ae(),void(X="decimalExponentSign")}if(re.isDigit(ee))return Z+=ae(),void(X="decimalExponentInteger");throw ve(ae())},decimalExponentSign:function(){if(re.isDigit(ee))return Z+=ae(),void(X="decimalExponentInteger");throw ve(ae())},decimalExponentInteger:function(){if(!re.isDigit(ee))return ce("numeric",K*Number(Z));Z+=ae()},hexadecimal:function(){if(re.isHexDigit(ee))return Z+=ae(),void(X="hexadecimalInteger");throw ve(ae())},hexadecimalInteger:function(){if(!re.isHexDigit(ee))return ce("numeric",K*Number(Z));Z+=ae()},string:function(){switch(ee){case"\\":return ae(),void(Z+=fe());case'"':return Q?(ae(),ce("string",Z)):void(Z+=ae());case"'":return Q?void(Z+=ae()):(ae(),ce("string",Z));case"\n":case"\r":throw ve(ae());case"\u2028":case"\u2029":ye(ee);break;case void 0:throw ve(ae())}Z+=ae()},start:function(){switch(ee){case"{":case"[":return ce("punctuator",ae())}X="value"},beforePropertyName:function(){switch(ee){case"$":case"_":return Z=ae(),void(X="identifierName");case"\\":return ae(),void(X="identifierNameStartEscape");case"}":return ce("punctuator",ae());case'"':case"'":return Q='"'===ae(),void(X="string")}if(re.isIdStartChar(ee))return Z+=ae(),void(X="identifierName");throw ve(ae())},afterPropertyName:function(){if(":"===ee)return ce("punctuator",ae());throw ve(ae())},beforePropertyValue:function(){X="value"},afterPropertyValue:function(){switch(ee){case",":case"}":return ce("punctuator",ae())}throw ve(ae())},beforeArrayValue:function(){if("]"===ee)return ce("punctuator",ae());X="value"},afterArrayValue:function(){switch(ee){case",":case"]":return ce("punctuator",ae())}throw ve(ae())},end:function(){throw ve(ae())}};function ce(e,t){return{type:e,value:t,line:H,column:V}}function le(e){for(var t=0,r=e;t<r.length;t+=1){var n=r[t];if(ie()!==n)throw ve(ae());ae()}}function fe(){switch(ie()){case"b":return ae(),"\b";case"f":return ae(),"\f";case"n":return ae(),"\n";case"r":return ae(),"\r";case"t":return ae(),"\t";case"v":return ae(),"\v";case"0":if(ae(),re.isDigit(ie()))throw ve(ae());return"\0";case"x":return ae(),De();case"u":return ae(),de();case"\n":case"\u2028":case"\u2029":return ae(),"";case"\r":return ae(),"\n"===ie()&&ae(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case void 0:throw ve(ae())}return ae()}function De(){var e="",t=ie();if(!re.isHexDigit(t))throw ve(ae());if(e+=ae(),t=ie(),!re.isHexDigit(t))throw ve(ae());return e+=ae(),String.fromCodePoint(parseInt(e,16))}function de(){for(var e="",t=4;t-- >0;){var r=ie();if(!re.isHexDigit(r))throw ve(ae());e+=ae()}return String.fromCodePoint(parseInt(e,16))}var pe={start:function(){if("eof"===q.type)throw me();he()},beforePropertyName:function(){switch(q.type){case"identifier":case"string":return Y=q.value,void(G="afterPropertyName");case"punctuator":return void ge();case"eof":throw me()}},afterPropertyName:function(){if("eof"===q.type)throw me();G="beforePropertyValue"},beforePropertyValue:function(){if("eof"===q.type)throw me();he()},beforeArrayValue:function(){if("eof"===q.type)throw me();"punctuator"!==q.type||"]"!==q.value?he():ge()},afterPropertyValue:function(){if("eof"===q.type)throw me();switch(q.value){case",":return void(G="beforePropertyName");case"}":ge()}},afterArrayValue:function(){if("eof"===q.type)throw me();switch(q.value){case",":return void(G="beforeArrayValue");case"]":ge()}},end:function(){}};function he(){var e;switch(q.type){case"punctuator":switch(q.value){case"{":e={};break;case"[":e=[]}break;case"null":case"boolean":case"numeric":case"string":e=q.value}if(void 0===J)J=e;else{var t=W[W.length-1];Array.isArray(t)?t.push(e):Object.defineProperty(t,Y,{value:e,writable:!0,enumerable:!0,configurable:!0})}if(null!==e&&"object"==typeof e)W.push(e),G=Array.isArray(e)?"beforeArrayValue":"beforePropertyName";else{var r=W[W.length-1];G=null==r?"end":Array.isArray(r)?"afterArrayValue":"afterPropertyValue"}}function ge(){W.pop();var e=W[W.length-1];G=null==e?"end":Array.isArray(e)?"afterArrayValue":"afterPropertyValue"}function ve(e){return Fe(void 0===e?"JSON5: invalid end of input at "+H+":"+V:"JSON5: invalid character '"+Ce(e)+"' at "+H+":"+V)}function me(){return Fe("JSON5: invalid end of input at "+H+":"+V)}function Ae(){return Fe("JSON5: invalid identifier character at "+H+":"+(V-=5))}function ye(e){console.warn("JSON5: '"+Ce(e)+"' in strings is not valid ECMAScript; consider escaping")}function Ce(e){var t={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(t[e])return t[e];if(e<" "){var r=e.charCodeAt(0).toString(16);return"\\x"+("00"+r).substring(r.length)}return e}function Fe(e){var t=new SyntaxError(e);return t.lineNumber=H,t.columnNumber=V,t}var be=function(e,t,r){var n,u,o,i=[],a="",s="";if(null==t||"object"!=typeof t||Array.isArray(t)||(r=t.space,o=t.quote,t=t.replacer),"function"==typeof t)u=t;else if(Array.isArray(t)){n=[];for(var c=0,l=t;c<l.length;c+=1){var f=l[c],D=void 0;"string"==typeof f?D=f:("number"==typeof f||f instanceof String||f instanceof Number)&&(D=String(f)),void 0!==D&&n.indexOf(D)<0&&n.push(D)}}return r instanceof Number?r=Number(r):r instanceof String&&(r=String(r)),"number"==typeof r?r>0&&(r=Math.min(10,Math.floor(r)),s="          ".substr(0,r)):"string"==typeof r&&(s=r.substr(0,10)),d("",{"":e});function d(e,t){var r=t[e];switch(null!=r&&("function"==typeof r.toJSON5?r=r.toJSON5(e):"function"==typeof r.toJSON&&(r=r.toJSON(e))),u&&(r=u.call(t,e,r)),r instanceof Number?r=Number(r):r instanceof String?r=String(r):r instanceof Boolean&&(r=r.valueOf()),r){case null:return"null";case!0:return"true";case!1:return"false"}return"string"==typeof r?p(r):"number"==typeof r?String(r):"object"==typeof r?Array.isArray(r)?v(r):h(r):void 0}function p(e){for(var t={"'":.1,'"':.2},r={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"},n="",u=0;u<e.length;u++){var i=e[u];switch(i){case"'":case'"':t[i]++,n+=i;continue;case"\0":if(re.isDigit(e[u+1])){n+="\\x00";continue}}if(r[i])n+=r[i];else if(i<" "){var a=i.charCodeAt(0).toString(16);n+="\\x"+("00"+a).substring(a.length)}else n+=i}var s=o||Object.keys(t).reduce((function(e,r){return t[e]<t[r]?e:r}));return s+(n=n.replace(new RegExp(s,"g"),r[s]))+s}function h(e){if(i.indexOf(e)>=0)throw TypeError("Converting circular structure to JSON5");i.push(e);var t=a;a+=s;for(var r,u,o=[],c=0,l=n||Object.keys(e);c<l.length;c+=1){var f=l[c],D=d(f,e);if(void 0!==D){var p=g(f)+":";""!==s&&(p+=" "),p+=D,o.push(p)}}if(0===o.length)r="{}";else if(""===s)r="{"+(u=o.join(","))+"}";else{var h=",\n"+a;u=o.join(h),r="{\n"+a+u+",\n"+t+"}"}return i.pop(),a=t,r}function g(e){if(0===e.length)return p(e);var t=String.fromCodePoint(e.codePointAt(0));if(!re.isIdStartChar(t))return p(e);for(var r=t.length;r<e.length;r++)if(!re.isIdContinueChar(String.fromCodePoint(e.codePointAt(r))))return p(e);return e}function v(e){if(i.indexOf(e)>=0)throw TypeError("Converting circular structure to JSON5");i.push(e);var t=a;a+=s;for(var r,n=[],u=0;u<e.length;u++){var o=d(String(u),e);n.push(void 0!==o?o:"null")}if(0===n.length)r="[]";else if(""===s)r="["+n.join(",")+"]";else{var c=",\n"+a,l=n.join(c);r="[\n"+a+l+",\n"+t+"]"}return i.pop(),a=t,r}},Ee={parse:ne,stringify:be},we=Ee,Be=we;return Be}()}(Ps);var Is=Xn(Ps.exports);function Ns(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ns(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ns(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ms(e,t,r,n){let u=e=>{let t={};try{t=Is.parse(e)}catch(t){console.log("c",e),console.log(t)}let r=[];try{r=(e=>{let t=[];return lt(e,((e,r)=>{let n={name:r};n=Zr(e)?$s($s({},n),e):$s($s({},n),{},{isActive:e}),t.push(n)})),t})(t)}catch(r){console.log("c",e),console.log("kp",t),console.log(r)}return r},o=(e,t,r)=>{let n=[];return lt(e,(e=>{let u=Ee(e,r,"");lt(t,(t=>{let o=Ee(t,r,"");if(u===o)return n.push($s($s({},e),{},{data:t})),!1}))})),n},i=e=>{let t=[];if(lt(e,(e=>{let r=Ee(e,"mode","");if("OR"!==r&&"AND"!==r)return!0;let n=Ee(e,"rules",[]),u={};lt(n,(e=>{u[e.name]=e.isActive})),t.push({mode:r,kpRule:u})})),0===Yr(t))return[];let r=Ka(t,{mode:"OR"}),n=Ka(t,{mode:"AND"}),u=null;Yr(r)>0?u=Ee(r,"0.kpRule"):Yr(n)>0&&(u=Ee(n,"0.kpRule")),lt(r,(e=>{let t=Ee(e,"kpRule",{});u=((e,t)=>{let r={};return lt([e,t],(e=>{lt(e,((e,t)=>{Mn(r,t)||(r[t]="n"),"y"===r[t]||"y"===e?r[t]="y":r[t]="n"}))})),r})(u,t)})),lt(n,((e,t)=>{let r=Ee(e,"kpRule",{});u=((e,t)=>{let r=lo(e);return lt([t],(e=>{lt(e,((e,t)=>{Mn(r,t)||(r[t]="n"),"y"===r[t]&&"y"===e?r[t]="y":r[t]="n"}))})),r})(u,r)}));let o=[];return lt(u,((e,t)=>{o.push({name:t,isActive:e})})),o},a=Ee(e,"cgrups",""),s=u(a);s=o(s,t,"name"),s=Ka(s,{isActive:"y"}),s=Sr(s,(e=>{let t=Ee(e,"data.cpemis",""),n=u(t);return n=Ka(n,{isActive:"y"}),n=o(n,r,"name"),e.data._pemis=n,e})),s=Sr(s,(e=>{let t=Ee(e,"data._pemis",[]);return t=Sr(t,(e=>{let t=Ee(e,"data.crules",""),r=u(t);return e.data._rules=r,e})),e.data._pemis=t,e}));let c=[];{let e=[];lt(s,(t=>{let r=t.mode,n=t.data._pemis,u=[];lt(n,(e=>{let t=e.mode,r=e.data._rules;u.push({mode:t,rules:r})}));let o={mode:r,rules:i(u)};e.push(o)})),c=i(e)}{let e={};lt(c,(t=>{e[t.name]=t.isActive})),lt(n,(t=>{Mn(e,t.id)||(e[t.id]="n")}));let t=[];lt(e,((e,r)=>{let n={name:r,isActive:e};t.push(n)})),c=t}return{grups:s,rules:c}}function Us(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Rs(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Us(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Us(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}return function(r,n,u,o,i,a){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},c=null;if(!On(r))throw console.log("invalid WOrm",r),new Error("invalid WOrm");if(!Kr(n))throw console.log("invalid url",n),new Error("invalid url");if(!Kr(u))throw console.log("invalid db",u),new Error("invalid db");if(!On(o))throw console.log("invalid getUserByToken",o),new Error("invalid getUserByToken");if(!On(i))throw console.log("invalid verifyBrowserUser",i),new Error("invalid verifyBrowserUser");if(!On(a))throw console.log("invalid verifyAppUser",a),new Error("invalid verifyAppUser");let l=Ee(s,"serverPort");bn(l)||(l=11006),l=Fn(l);let f=Ee(s,"bCheckUser",!1),D=Ee(s,"getUserById",null),d=Ee(s,"bExcludeWhenNotAdmin",!1),p=Ee(s,"webName",{}),h=Ee(s,"webDescription",{}),g=Ee(s,"webLogo",""),v=Ee(s,"subfolder","");var m,A;Kr(v)&&("/"===function(e,t){if(!Kr(e))return"";if(!Tn(t))return"";if(0===(t=Fn(t)))return"";let r=e.length-t;return r<0&&(r=0),e.substring(r,r+t)}(v,1)&&(A=1,v=Kr(m=v)&&Tn(A)?0===(A=Fn(A))?m:kn(m,m.length-A):""),"/"!==kn(v,1)&&(v=`/${v}`));let y=Ee(s,"urlRedirect",""),C=Ee(s,"showLanguage","n"),F=Ee(s,"language","eng"),b=Ee(s,"showModeEditTargets","n"),E=Ee(s,"showModeEditPemis","n"),w=Ee(s,"showModeEditGrups","n"),B=Ee(s,"showModeEditUsers","n"),j=Ee(s,"modeEditTargets","n"),S=Ee(s,"modeEditPemis","n"),O=Ee(s,"modeEditGrups","n"),x=Ee(s,"modeEditUsers","n"),_=Ee(s,"widthTargetId",""),T=Ee(s,"widthTargetDescription",""),k=Ee(s,"widthPemisName",""),P=Ee(s,"widthPemisDescription",""),I=Ee(s,"widthGrupsName",""),N=Ee(s,"widthGrupsDescription",""),$=Ee(s,"widthUsersName",""),M=Ee(s,"widthUsersEmail",""),U=Ee(s,"widthUsersDescription",""),R=Ee(s,"mappingBy","");"id"!==R&&"email"!==R&&"name"!==R&&(R="id");let L={bCheckUser:f,getUserById:D,bExcludeWhenNotAdmin:d},G={};try{G=ps(ks,r,n,u,L)}catch(e){console.log(e)}let{woItems:W,procOrm:z}=G,H=e=>({webName:p,webDescription:h,webLogo:g,showLanguage:C,language:F,showModeEditTargets:b,showModeEditPemis:E,showModeEditGrups:w,showModeEditUsers:B,modeEditTargets:j,modeEditPemis:S,modeEditGrups:O,modeEditUsers:x,widthTargetId:_,widthTargetDescription:T,widthPemisName:k,widthPemisDescription:P,widthGrupsName:I,widthGrupsDescription:N,widthUsersName:$,widthUsersEmail:M,widthUsersDescription:U}),V=async(e,t,r,n)=>{r=Sr(r=Vn(r,ks[e].keys),((e,t)=>(e.order=t+1,e)));let u=(e,t)=>{let r=null,n={};return lt(e,((e,u)=>{let o=Ee(e,t,"");return Kr(o)?Mn(n,o)?(r=`rows[${u}].${t}[${o}] is duplicate`,!1):void(n[o]=!0):(r=`rows[${u}].${t} is not an effective string`,!1)})),r},o=null;if(Rn(e,["targets"])){if(o=u(r,"id"),null!==o)return Promise.reject(o)}else if(Rn(e,["targets","pemis","grups"])){if(o=u(r,"name"),null!==o)return Promise.reject(o)}else if(Rn(e,["users"])&&(o=u(r,"email"),null!==o))return Promise.reject(o);let i=r,a=function(e,t,r){let n={infor:{},del:[],same:[],diff:[],add:[]};if(!Kr(r))return console.log("invalid key"),n;En(e)||(e=[e]),En(t)||(t=[t]);let u={},o=[],i=[],a=[];lt(e,(function(e){if(Mn(e,r)){let n={[r]:e[r]},s=zn(t,n);jn(s)?(o.push(e),u[e[r]]="del"):Un(e,s)?(a.push(s),u[s[r]]="same"):(i.push(s),u[s[r]]="diff")}}));let s=[];return lt(t,(function(t){if(Mn(t,r)){let n={[r]:t[r]};jn(zn(e,n))&&(s.push(t),u[t[r]]="add")}})),{infor:u,del:o,same:a,diff:i,add:s}}(await W[e].select(),i,n);return Yr(a.del)>0&&await z(t,e,"del",a.del),Yr(a.add)>0&&await z(t,e,"insert",a.add),Yr(a.diff)>0&&await z(t,e,"save",a.diff),i},q=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=await(async e=>{let t=null;if(Kr(e)&&(t=o(e),xn(t)&&(t=await t)),!Zr(t))return console.log("token",e),console.log("can not find the user from token"),Promise.reject("can not find the user from token");{if(!Kr(Ee(t,"id","")))return console.log("userSelf",t),console.log("can not get the userId"),Promise.reject("can not get the userId");if(!Kr(Ee(t,"email","")))return console.log("userSelf",t),console.log("can not get the email of user"),Promise.reject("can not get the email of user");if(!Kr(Ee(t,"name","")))return console.log("userSelf",t),console.log("can not get userName"),Promise.reject("can not get userName");let e=Ee(t,"isAdmin","");if("y"!==e&&"n"!==e)return console.log("userSelf",t),console.log("userSelf.isAdmin is not y or n",t.isAdmin),console.log("can not get the role of user"),Promise.reject("can not get the role of user")}let r=Ee(t,R,"");if(!Kr(r))return console.log("userSelf",t),console.log("mappingBy",R),console.log("can not get the prop of user by mappingBy"),Promise.reject("can not get the prop of user by mappingBy");let n=await W.users.select({[R]:r,isActive:"y"});if(n=Ee(n,0,null),!Zr(n))return console.log("userSelf",t),console.log("mappingBy",R),console.log("can not get the user from perm"),Promise.reject("can not get the user from perm");let u=Ee(t,"isAdmin",""),i=Ee(n,"isAdmin","");return u!==i&&(n.isAdmin=i),n})(e),n=i(r,t);return xn(n)&&(n=await n),n?r:(console.log("userSelf",r),console.log("user does not have permission"),Promise.reject("user does not have permission"))},Y=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=null;if(Kr(e)&&(r=o(e),xn(r)&&(r=await r)),!Zr(r))return console.log("token",e),console.log("can not find the user from token"),Promise.reject("can not find the user from token");let n=a(r,t);return xn(n)&&(n=await n),n?r:(console.log("userSelf",r),console.log("user does not have permission"),Promise.reject("user does not have permission"))},J=async(e,t)=>{let r=Ee(e,"payload");if(Kr(r)&&(r=_n(r)),!Zr(r))return console.log("inp",r),console.log("invalid inp from req"),Promise.reject("invalid inp from req");let n=Ee(r,"from","");if(!Kr(n))return console.log("inp",r),console.log("from",n),console.log("invalid from from inp"),Promise.reject("invalid from from inp");let u=Ee(r,t,[]);return Sn(u)?(r={from:n,[t]:u},r):(console.log("inp",r),console.log(t,u),console.log(`invalid ${t} from inp`),Promise.reject(`invalid ${t} from inp`))},X=async(e,t,r)=>{let n=Ee(t,"from","");if(!Kr(n))return console.log("params",t),console.log("from",n),console.log("invalid from"),Promise.reject("invalid from");let u=Ee(t,r,[]);return Sn(u)?(u=Sr(u,((e,t)=>(e.from=n,e))),u=Vn(u,ks[r].keys),await W[r].delAll({from:n}),await z(e,r,"insert",u)):(console.log("params",t),console.log("woName",r),Promise.reject(`invalid ${r}`))},Z=async e=>{let t=await(async(e,t)=>{let r=await W.users.select({[e]:t,isActive:"y"});return r=Ee(r,0,null),Zr(r)?r:null})("id",e);return Zr(t)?t:null},Q=async e=>{let t=await Z(e),r=Ms(t,await W.grups.select(),await W.pemis.select(),await W.targets.select());if(!Zr(r))return console.log("userId",e),console.log("can not get rules of user"),Promise.reject("can not get rules of user");let n=Sr(Ee(r,"grups",[]),"name");var u,o;return o=";",n=null==(u=n)?"":Jr.call(u,o),{user:Rs(Rs({},t),{},{grupsNames:n}),rules:Ee(r,"rules",[])}},K="dist",ee="./node_modules/w-web-perm/dist";var te;te=ee,!t.existsSync(te)||t.lstatSync(te).isFile()||t.lstatSync(te).isSymbolicLink()||(K=ee);let re="index.html";try{let r=e.resolve(K,"index.tmp");if(Nn(r)||(r=e.resolve(K,re)),!Nn(r))throw console.log("fpEntryIn",r),new Error("invalid fpEntryIn");let n=e.resolve(K,re),u=t.readFileSync(r,"utf8");u=$n(u,"/mperm/","{sfd}/"),u=$n(u,"{sfd}",v),u=$n(u,"{urlRedirect}",y),u=$n(u,"{language}",F),t.writeFileSync(n,u,"utf8")}catch(e){console.log(e),console.log(`can not generate ${re}`)}let ne=[{method:"GET",path:"/getWebInfor",handler:async function(e,t){return H()}},{method:"GET",path:"/api/getUserByToken",handler:async function(e,t){return await In((async function(){let t=Ee(e,"query.token",""),r=await q(t,"getUserByToken");return Zr(r)?r:(console.log("token",t),console.log("[API]getUserByToken/check userSelf: invalid userSelf"),console.log("token does not have permission"),Promise.reject("token does not have permission"))}))()}},{method:"GET",path:"/api/getPerm",handler:async function(e,t){let r=await In((async function(){let t=(e=>Ee(e,"query.token",""))(e),r=await q(t,"getPerm");if(!Zr(r))return console.log("token",t),console.log("[API]getPerm/check userLogin: invalid userLogin"),console.log("token does not have permission"),Promise.reject("token does not have permission");let n=Ee(r,"id","");if(!Kr(n))return console.log("userLogin",r),console.log("[API]getPerm/check userId: invalid userId"),console.log("token does not have permission"),Promise.reject("token does not have permission");let u=await Q(n);return Zr(u)?u:(console.log("userLogin",r),console.log("[API]getPerm/getGenUserAndRulesByUserId: user does not have permrules"),console.log("token does not have permission"),Promise.reject("token does not have permission"))}))();return r}},{method:"GET",path:"/api/getPermById",handler:async function(e,t){return await In((async function(){let t=Ee(e,"query.token",""),r=await Y(t,"getPermById");if(!Zr(r))return console.log("token",t),console.log("[API]getPermById/check userSelf: invalid userSelf"),console.log("token does not have permission"),Promise.reject("token does not have permission");let n=Ee(e,"query.userId",""),u=await Q(n);return Zr(u)?u:(console.log("userSelf",r),console.log("[API]getPermById/getGenUserAndRulesByUserId: user does not have permrules"),console.log("user does not have permrules"),Promise.reject("user does not have permrules"))}))()}},{method:"POST",path:"/syncAndReplaceTargets",handler:async function(e,t){return await In((async function(){let t=Ee(e,"query.token",""),r=await Y(t,"syncAndReplaceTargets");if(!Zr(r))return console.log("token",t),console.log("[API]syncAndReplaceTargets/check user: invalid user"),console.log("token does not have permission"),Promise.reject("token does not have permission");let n=Ee(r,"id",""),u=await J(e,"targets");return await X(n,u,"targets")}))()}},{method:"POST",path:"/syncAndReplacePemis",handler:async function(e,t){return await In((async function(){let t=Ee(e,"query.token",""),r=await Y(t,"syncAndReplacePemis");if(!Zr(r))return console.log("token",t),console.log("[API]syncAndReplacePemis/check user: invalid user"),console.log("token does not have permission"),Promise.reject("token does not have permission");let n=await J(e,"pemis"),u=Ee(r,"id","");return await X(u,n,"pemis")}))()}},{method:"POST",path:"/syncAndReplaceGrups",handler:async function(e,t){return await In((async function(){let t=Ee(e,"query.token",""),r=await Y(t,"syncAndReplaceGrups");if(!Zr(r))return console.log("token",t),console.log("[API]syncAndReplaceGrups/check user: invalid user"),console.log("token does not have permission"),Promise.reject("token does not have permission");let n=await J(e,"grups"),u=Ee(r,"id","");return await X(u,n,"grups")}))()}},{method:"POST",path:"/syncAndReplaceUsers",handler:async function(e,t){return await In((async function(){let t=Ee(e,"query.token",""),r=await Y(t,"syncAndReplaceUsers");if(!Zr(r))return console.log("token",t),console.log("[API]syncAndReplaceUsers/check user: invalid user"),console.log("token does not have permission"),Promise.reject("token does not have permission");let n=await J(e,"users"),u=Ee(r,"id","");return await X(u,n,"users")}))()}}],ue=it(ks),oe=ue;return c=new Fi({port:s.serverPort,pathStaticFiles:K,apis:ne,getUserIDFromToken:async e=>{let t=Ee(await o(e),"id","");return Kr(t)?t:(console.log("token",e),console.log("userId",t),Promise.reject("can not find user.id"))},useDbORM:!0,dbORMs:W,operORM:z,tableNamesExec:ue,methodsExec:["select","insert","save","del","delAll"],tableNamesSync:oe,extFuncs:{getWebInfor:H,getTargetsList:async e=>await W.targets.select(),getRuleGroupsList:async e=>await W.pemis.select(),getUsersList:async e=>await W.users.select(),updateTargets:async(e,t)=>t=await V("targets",e,t,"id"),updatePemis:async(e,t)=>t=await V("pemis",e,t,"name"),updateGrups:async(e,t)=>t=await V("grups",e,t,"name"),updateUsers:async(e,t)=>t=await V("users",e,t,"id")},hookBefores:null,hookAfters:null,fnTableTags:"tableTags-web-perm.json"}),c}}));
//# sourceMappingURL=w-web-perm.umd.js.map
